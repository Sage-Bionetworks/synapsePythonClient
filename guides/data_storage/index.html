
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python client for Sage Bionetworks' Synapse, a collaborative, open-source research platform that allows teams to share data, track analyses, and collaborate. The Python client can be used as a library for development of software that communicates with Synapse or as a command-line utility.">
      
      
        <meta name="author" content="Bryan Fauble">
      
      
      
        <link rel="prev" href="../views/">
      
      
        <link rel="next" href="../accessing_the_rest_api/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Data Storage - Synapse Python/Command Line Client Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-storage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Synapse Python/Command Line Client Documentation" class="md-header__button md-logo" aria-label="Synapse Python/Command Line Client Documentation" data-md-component="logo">
      
  <img src="../../assets/synapse_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Synapse Python/Command Line Client Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Storage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    synapsePythonClient
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/home/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../home/" class="md-tabs__link">
          
  
  How-To Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/client/" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../explanations/home/" class="md-tabs__link">
          
  
  Further Reading

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../news/" class="md-tabs__link">
          
  
  News

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Synapse Python/Command Line Client Documentation" class="md-nav__button md-logo" aria-label="Synapse Python/Command Line Client Documentation" data-md-component="logo">
      
  <img src="../../assets/synapse_logo.png" alt="logo">

    </a>
    Synapse Python/Command Line Client Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    synapsePythonClient
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Working with the Python client
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Working with the Python client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/folder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/upload_data_in_bulk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload data in bulk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/python/download_data_in_bulk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download data in bulk
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/command_line_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with the Command Line Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/file_versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with file versioning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/reticulate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synapseclient with R through reticulate
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    How-To Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Entity Views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Data Storage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Data Storage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3-storage-features" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Storage Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-storage-locations" class="md-nav__link">
    <span class="md-ellipsis">
      External storage locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External storage locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-new-folder-backed-by-a-user-specified-s3-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new folder backed by a user specified S3 bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-new-project-backed-by-a-user-specified-s3-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new project backed by a user specified S3 bucket
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-location-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Storage location migration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage location migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migrating-programmatically" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating programmatically
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating programmatically">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#putting-all-the-migration-pieces-together" class="md-nav__link">
    <span class="md-ellipsis">
      Putting all the migration pieces together
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-from-the-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating from the command line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sts-storage-locations" class="md-nav__link">
    <span class="md-ellipsis">
      STS Storage Locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STS Storage Locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-sts-enabled-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an STS enabled folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-credentials-with-the-awscli" class="md-nav__link">
    <span class="md-ellipsis">
      Using credentials with the awscli
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-credentials-with-boto3-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Using credentials with boto3 in python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-transfers-tofrom-sts-storage-locations-using-boto3-with-synapseclient" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic transfers to/from STS storage locations using boto3 with synapseclient
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sftp" class="md-nav__link">
    <span class="md-ellipsis">
      SFTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SFTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-on-unix-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Installing on Unix variants
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Installing on Windows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-your-client" class="md-nav__link">
    <span class="md-ellipsis">
      Configure your client
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing_the_rest_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access the REST API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Expermental Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Expermental Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validate_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validating Annotations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/synapse_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synapse Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/entity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/folder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/table_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/view_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity View Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/activity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activity/Provenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/teams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Teams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/wiki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wiki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/docker_repository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DockerRepository
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/rest_apis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Apis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_22" >
        
          
          <label class="md-nav__link" for="__nav_4_22" id="__nav_4_22_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_22">
            <span class="md-nav__icon md-icon"></span>
            Experimental
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/oop/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Object-Orientated Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/oop/models_async/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Object-Orientated Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Further Reading
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Further Reading
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/domain_models_of_synapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Models of Synapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/access_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/properties_vs_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Properties vs Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/manifest_tsv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manifest TSV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/benchmarking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Benchmarking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanations/structuring_your_project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structuring Your Project
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    News
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            News
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3-storage-features" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Storage Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-storage-locations" class="md-nav__link">
    <span class="md-ellipsis">
      External storage locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External storage locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-new-folder-backed-by-a-user-specified-s3-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new folder backed by a user specified S3 bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-new-project-backed-by-a-user-specified-s3-bucket" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new project backed by a user specified S3 bucket
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-location-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Storage location migration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage location migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migrating-programmatically" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating programmatically
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating programmatically">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#putting-all-the-migration-pieces-together" class="md-nav__link">
    <span class="md-ellipsis">
      Putting all the migration pieces together
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-from-the-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating from the command line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sts-storage-locations" class="md-nav__link">
    <span class="md-ellipsis">
      STS Storage Locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STS Storage Locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-sts-enabled-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an STS enabled folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-credentials-with-the-awscli" class="md-nav__link">
    <span class="md-ellipsis">
      Using credentials with the awscli
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-credentials-with-boto3-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Using credentials with boto3 in python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-transfers-tofrom-sts-storage-locations-using-boto3-with-synapseclient" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic transfers to/from STS storage locations using boto3 with synapseclient
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sftp" class="md-nav__link">
    <span class="md-ellipsis">
      SFTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SFTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-on-unix-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Installing on Unix variants
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Installing on Windows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-your-client" class="md-nav__link">
    <span class="md-ellipsis">
      Configure your client
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="data-storage">Data Storage<a class="headerlink" href="#data-storage" title="Permanent link">&para;</a></h1>
<h2 id="s3-storage-features">S3 Storage Features<a class="headerlink" href="#s3-storage-features" title="Permanent link">&para;</a></h2>
<p>Synapse can use a variety of storage mechanisms to store content, however the most common storage solution is AWS S3. This article illustrates some special features that can be used with S3 storage and how they interact with the Python client. In particular it covers:</p>
<ol>
<li>Linking External storage locations to new/existing projects or folders</li>
<li>Migration of existing projects or folders to new external storage locations</li>
<li>Creating STS enabled storage locations</li>
<li>Using SFTP</li>
</ol>
<h2 id="external-storage-locations">External storage locations<a class="headerlink" href="#external-storage-locations" title="Permanent link">&para;</a></h2>
<p>Synapse projects or folders can be configured to use custom implementations for their underlying data storage. More information on this feature can be found <a href="https://help.synapse.org/docs/Custom-Storage-Locations.2048327803.html">here</a>. The most common implementation of this is to configure a folder to store data in a user controlled AWS S3 bucket rather than Synapse's default internal S3 storage.</p>
<h3 id="creating-a-new-folder-backed-by-a-user-specified-s3-bucket">Creating a new folder backed by a user specified S3 bucket<a class="headerlink" href="#creating-a-new-folder-backed-by-a-user-specified-s3-bucket" title="Permanent link">&para;</a></h3>
<p>The following illustrates creating a new folder backed by a user specified S3 bucket. Note: An existing folder also works.</p>
<p>If you are changing the storage location of an existing folder to a user specified S3 bucket none of the files will be migrated. In order to migrate the files to the new storage location see the section <a href="#migrating-programmatically">Migrating programmatically</a>. When you change the storage location for a folder only NEW files uploaded to the folder are uploaded to the user specific S3 bucket.</p>
<ol>
<li>
<p>Ensure that the bucket is <a href="https://help.synapse.org/docs/Custom-Storage-Locations.2048327803.html#CustomStorageLocations-SettingUpanExternalAWSS3Bucket">properly configured</a>.</p>
</li>
<li>
<p>Create a folder and configure it to use external S3 storage:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># create a new folder to use with external S3 storage</span>
<span class="n">folder</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Folder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">folder_name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">))</span>
<span class="c1"># You may also use an existing folder like:</span>
<span class="c1"># folder = syn.get(&quot;syn123&quot;)</span>
<span class="n">folder</span><span class="p">,</span> <span class="n">storage_location</span><span class="p">,</span> <span class="n">project_setting</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">create_s3_storage_location</span><span class="p">(</span>
    <span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">,</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="s1">&#39;my-external-synapse-bucket&#39;</span><span class="p">,</span>
    <span class="n">base_key</span><span class="o">=</span><span class="s1">&#39;path/within/bucket&#39;</span><span class="p">,</span>
 <span class="p">)</span>

<span class="c1"># if needed the unique storage location identifier can be obtained e.g.</span>
<span class="n">storage_location_id</span> <span class="o">=</span> <span class="n">storage_location</span><span class="p">[</span><span class="s1">&#39;storageLocationId&#39;</span><span class="p">]</span>
</code></pre></div>
<h3 id="creating-a-new-project-backed-by-a-user-specified-s3-bucket">Creating a new project backed by a user specified S3 bucket<a class="headerlink" href="#creating-a-new-project-backed-by-a-user-specified-s3-bucket" title="Permanent link">&para;</a></h3>
<p>The following illustrates creating a new project backed by a user specified S3 bucket. Note: An existing project also works.</p>
<p>If you are changing the storage location of an existing project to a user specified S3 bucket none of the files will be migrated. In order to migrate the files to the new storage location see the documentation further down in this article labeled 'Migrating programmatically'. When you change the storage location for a project only NEW files uploaded to the project are uploaded to the user specific S3 bucket.</p>
<ol>
<li>
<p>Ensure that the bucket is <a href="https://help.synapse.org/docs/Custom-Storage-Locations.2048327803.html#CustomStorageLocations-SettingUpanExternalAWSS3Bucket">properly configured</a>.</p>
</li>
<li>
<p>Create a project and configure it to use external S3 storage:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># create a new, or retrieve an existing project to use with external S3 storage</span>
<span class="n">project</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Project</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_project_name&quot;</span><span class="p">))</span>
<span class="n">project_storage</span><span class="p">,</span> <span class="n">storage_location</span><span class="p">,</span> <span class="n">project_setting</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">create_s3_storage_location</span><span class="p">(</span>
    <span class="c1"># Despite the KW argument name, this can be a project or folder</span>
    <span class="n">folder</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="s1">&#39;my-external-synapse-bucket&#39;</span><span class="p">,</span>
    <span class="n">base_key</span><span class="o">=</span><span class="s1">&#39;path/within/bucket&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># if needed the unique storage location identifier can be obtained e.g.</span>
<span class="n">storage_location_id</span> <span class="o">=</span> <span class="n">storage_location</span><span class="p">[</span><span class="s1">&#39;storageLocationId&#39;</span><span class="p">]</span>
</code></pre></div>
<p>Once an external S3 storage folder exists, you can interact with it as you would any other folder using Synapse tools. If you wish to add an object that is stored within the bucket to Synapse you can do that by adding a file handle for that object using the Python client and then storing the file to that handle.</p>
<div class="highlight"><pre><span></span><code><span class="n">parent_synapse_folder_id</span> <span class="o">=</span> <span class="s1">&#39;syn123&#39;</span>
<span class="n">local_file_path</span> <span class="o">=</span> <span class="s1">&#39;/path/to/local/file&#39;</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="s1">&#39;my-external-synapse-bucket&#39;</span>
<span class="n">s3_key</span> <span class="o">=</span> <span class="s1">&#39;path/within/bucket/file&#39;</span>

<span class="c1"># in this example we use boto to create a file independently of Synapse</span>
<span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">s3_client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
    <span class="n">Filename</span><span class="o">=</span><span class="n">local_file_path</span><span class="p">,</span>
    <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
    <span class="n">Key</span><span class="o">=</span><span class="n">s3_key</span>
<span class="p">)</span>

<span class="c1"># now we add a file handle for that file and store the file to that handle</span>
<span class="n">file_handle</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">create_external_s3_file_handle</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">,</span>
    <span class="n">s3_key</span><span class="p">,</span>
    <span class="n">local_file_path</span><span class="p">,</span>
    <span class="n">parent</span><span class="o">=</span><span class="n">parent_synapse_folder_id</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">parentId</span><span class="o">=</span><span class="n">folder</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">dataFileHandleId</span><span class="o">=</span><span class="n">file_handle</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">file_entity</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</code></pre></div>
<h2 id="storage-location-migration">Storage location migration<a class="headerlink" href="#storage-location-migration" title="Permanent link">&para;</a></h2>
<p>There are circumstances where it can be useful to move the files underlying Synapse entities from one storage location to another without impacting the structure or identifiers of the Synapse entities themselves. An example scenario is needing to use STS features with an existing Synapse Project that was not initially configured with an STS enabled <a href="#sts-storage-locations">custom storage location</a>.</p>
<p>The Synapse client has utilities for migrating entities to a new storage location without having to download the content locally and re-uploading it which can be slow, and may alter the meta data associated with the entities in undesirable ways.</p>
<p>During the migration it is recommended that uploads and downloads are blocked to prevent possible conflicts or race conditions. This can be done by setting permissions to <code>Can view</code> for the project or folder being migrated. After the migration is complete set the permissions back to their original values.</p>
<p>Expected time to migrate data is around 13 minutes per 100Gb as of 11/21/2023.</p>
<h3 id="migrating-programmatically">Migrating programmatically<a class="headerlink" href="#migrating-programmatically" title="Permanent link">&para;</a></h3>
<p>Migrating a Synapse project or folder programmatically is a two step process.</p>
<p>First ensure that you know the id of the storage location you want to migrate to. More info on storage locations can be found above and <a href="https://help.synapse.org/docs/Custom-Storage-Locations.2048327803.html">here</a>.</p>
<p>Once the storage location is known, the first step to migrate the project or folder is to create a migratable index of its contents using the <a href="synapseutils.migrate_functions.index_files_for_migration">index_files_for_migration</a> function, e.g.</p>
<p>When specifying the <code>.db</code> file for the migratable indexes you need to specify a <code>.db</code> file that does not already exist for another synapse project or folder on disk. It is the best practice to specify a unique name for the file by including the synapse id in the name of the file, or other unique identifier.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">synapseutils</span>

<span class="n">entity_id</span> <span class="o">=</span> <span class="s1">&#39;syn123&#39;</span>  <span class="c1"># a Synapse entity whose contents need to be migrated, e.g. a Project or Folder</span>
<span class="n">dest_storage_location_id</span> <span class="o">=</span> <span class="s1">&#39;12345&#39;</span>  <span class="c1"># the id of the destination storage location being migrated to</span>

<span class="c1"># a path on disk where this utility can create a sqlite database to store its index.</span>
<span class="c1"># nothing needs to exist at this path, but it must be a valid path on a volume with sufficient</span>
<span class="c1"># disk space to store a meta data listing of all the contents in the indexed entity.</span>
<span class="c1"># a rough rule of thumb is 100kB per 1000 entities indexed.</span>
<span class="n">db_path</span> <span class="o">=</span> <span class="s1">&#39;/tmp/foo/syn123_bar.db&#39;</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="o">.</span><span class="n">index_files_for_migration</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">entity_id</span><span class="p">,</span>
    <span class="n">dest_storage_location_id</span><span class="p">,</span>
    <span class="n">db_path</span><span class="p">,</span>

    <span class="c1"># optional args, see function documentation linked above for a description of these parameters</span>
    <span class="n">source_storage_location_ids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;54321&#39;</span><span class="p">,</span> <span class="s1">&#39;98765&#39;</span><span class="p">],</span>
    <span class="n">file_version_strategy</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span>
    <span class="n">include_table_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<p>If called on a container (e.g. a Project or Folder) the <em>index_files_for_migration</em> function will recursively index all of the children of that container (including its subfolders). Once the entity has been indexed you can optionally programmatically inspect the the contents of the index or output its contents to a csv file in order to manually inspect it using the <a href="synapseutils.html#synapseutils.migrate_functions.MigrationResult">available methods</a> on the returned result object.</p>
<p>The next step to trigger the migration from the indexed files is using the <a href="synapseutils.html#synapseutils.migrate_functions.migrate_indexed_files">migrate_indexed_files</a> function, e.g.</p>
<div class="highlight"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="o">.</span><span class="n">migrate_indexed_files</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">db_path</span><span class="p">,</span>

    <span class="c1"># optional args, see function documentation linked above for a description of these parameters</span>
    <span class="n">create_table_snapshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">force</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<p>The result can be again be inspected as above to see the results of the migration.</p>
<p>Note that above the <em>force</em> parameter is necessary if running from a non-interactive shell. Proceeding with a migration requires confirmation in the form of user prompt. If running programmatically this parameter instead confirms your intention to proceed with the migration.</p>
<h4 id="putting-all-the-migration-pieces-together">Putting all the migration pieces together<a class="headerlink" href="#putting-all-the-migration-pieces-together" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">synapseutils</span>
<span class="kn">import</span> <span class="nn">synapseclient</span>

<span class="n">my_synapse_project_or_folder_to_migrate</span> <span class="o">=</span> <span class="s2">&quot;syn123&quot;</span>

<span class="n">external_bucket_name</span> <span class="o">=</span> <span class="s2">&quot;my-external-synapse-bucket&quot;</span>
<span class="n">external_bucket_base_key</span> <span class="o">=</span> <span class="s2">&quot;path/within/bucket/&quot;</span>

<span class="n">my_user_id</span> <span class="o">=</span> <span class="s2">&quot;1234&quot;</span>

<span class="c1"># a path on disk where this utility can create a sqlite database to store its index.</span>
<span class="c1"># nothing needs to exist at this path, but it must be a valid path on a volume with sufficient</span>
<span class="c1"># disk space to store a meta data listing of all the contents in the indexed entity.</span>
<span class="c1"># a rough rule of thumb is 100kB per 1000 entities indexed.</span>
<span class="n">db_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;~/synapseMigration/</span><span class="si">{</span><span class="n">my_synapse_project_or_folder_to_migrate</span><span class="si">}</span><span class="s2">_my.db&quot;</span>
<span class="p">)</span>

<span class="n">syn</span> <span class="o">=</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">Synapse</span><span class="p">()</span>

<span class="c1"># Log-in with ~.synapseConfig `authToken`</span>
<span class="n">syn</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>

<span class="c1"># The project or folder I want to migrate everything to this S3 storage location</span>
<span class="n">project_or_folder</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">my_synapse_project_or_folder_to_migrate</span><span class="p">)</span>

<span class="n">project_or_folder</span><span class="p">,</span> <span class="n">storage_location</span><span class="p">,</span> <span class="n">project_setting</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">create_s3_storage_location</span><span class="p">(</span>
    <span class="c1"># Despite the KW argument name, this can be a project or folder</span>
    <span class="n">folder</span><span class="o">=</span><span class="n">project_or_folder</span><span class="p">,</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="n">external_bucket_name</span><span class="p">,</span>
    <span class="n">base_key</span><span class="o">=</span><span class="n">external_bucket_base_key</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The id of the destination storage location being migrated to</span>
<span class="n">storage_location_id</span> <span class="o">=</span> <span class="n">storage_location</span><span class="p">[</span><span class="s2">&quot;storageLocationId&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Indexing: </span><span class="si">{</span><span class="n">project_or_folder</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> for migration to storage_id: </span><span class="si">{</span><span class="n">storage_location_id</span><span class="si">}</span><span class="s2"> at: </span><span class="si">{</span><span class="n">db_path</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="o">.</span><span class="n">index_files_for_migration</span><span class="p">(</span>
        <span class="n">syn</span><span class="p">,</span>
        <span class="n">project_or_folder</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">storage_location_id</span><span class="p">,</span>
        <span class="n">db_path</span><span class="p">,</span>
        <span class="n">file_version_strategy</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Indexing result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_counts_by_status</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Migrating files...&quot;</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="o">.</span><span class="n">migrate_indexed_files</span><span class="p">(</span>
        <span class="n">syn</span><span class="p">,</span>
        <span class="n">db_path</span><span class="p">,</span>
        <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Migration result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_counts_by_status</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">syn</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
        <span class="n">userIds</span><span class="o">=</span><span class="p">[</span><span class="n">my_user_id</span><span class="p">],</span>
        <span class="n">messageSubject</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Migration success for </span><span class="si">{</span><span class="n">project_or_folder</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">messageBody</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Migration result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_counts_by_status</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">syn</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
        <span class="n">userIds</span><span class="o">=</span><span class="p">[</span><span class="n">my_user_id</span><span class="p">],</span>
        <span class="n">messageSubject</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Migration failed for </span><span class="si">{</span><span class="n">project_or_folder</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">messageBody</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Migration failed with error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
<p>The result of running this should look like</p>
<div class="highlight"><pre><span></span><code><span class="n">Indexing</span><span class="p">:</span> <span class="n">syn123</span> <span class="k">for</span> <span class="n">migration</span> <span class="n">to</span> <span class="n">storage_id</span><span class="p">:</span> <span class="mi">11111</span> <span class="n">at</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">synapseMigration</span><span class="o">/</span><span class="n">syn123_my</span><span class="o">.</span><span class="n">db</span>
<span class="n">Indexing</span> <span class="n">result</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;INDEXED&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;MIGRATED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ALREADY_MIGRATED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ERRORED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">Migrating</span> <span class="n">files</span><span class="o">...</span>
<span class="n">Migration</span> <span class="n">result</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;INDEXED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;MIGRATED&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;ALREADY_MIGRATED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ERRORED&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</code></pre></div>
<h3 id="migrating-from-the-command-line">Migrating from the command line<a class="headerlink" href="#migrating-from-the-command-line" title="Permanent link">&para;</a></h3>
<p>Synapse entities can also be migrated from the command line. The options are similar to above.
Whereas migrating programatically involves two separate function calls, from the command line
there is a single <code>migrate</code> command with the <em>dryRun</em> argument providing the option
to generate the index only without proceeding onto the migration.</p>
<p>Note that as above, confirmation is required before a migration starts. As above, this must either be
in the form of confirming via a prompt if running the command from an interactive shell, or using the <em>force</em>
command.</p>
<p>The optional <em>csv_log_path</em> argument will output the results to a csv file for record keeping, and is recommended.</p>
<div class="highlight"><pre><span></span><code>synapse<span class="w"> </span>migrate<span class="w"> </span>syn123<span class="w"> </span><span class="m">54321</span><span class="w"> </span>/tmp/migrate.db<span class="w"> </span>--csv_log_path<span class="w"> </span>/tmp/migrate.csv
</code></pre></div>
<p>Sample output:</p>
<div class="highlight"><pre><span></span><code>Indexing<span class="w"> </span>Project<span class="w"> </span>syn123
Indexing<span class="w"> </span>file<span class="w"> </span>entity<span class="w"> </span>syn888
Indexing<span class="w"> </span>file<span class="w"> </span>entity<span class="w"> </span>syn999
Indexed<span class="w"> </span><span class="m">2</span><span class="w"> </span>items,<span class="w"> </span><span class="m">2</span><span class="w"> </span>needing<span class="w"> </span>migration,<span class="w"> </span><span class="m">0</span><span class="w"> </span>already<span class="w"> </span>stored<span class="w"> </span><span class="k">in</span><span class="w"> </span>destination<span class="w"> </span>storage<span class="w"> </span>location<span class="w"> </span><span class="o">(</span><span class="m">54321</span><span class="o">)</span>.<span class="w"> </span>Encountered<span class="w"> </span><span class="m">0</span><span class="w"> </span>errors.
<span class="m">21</span><span class="w"> </span>items<span class="w"> </span><span class="k">for</span><span class="w"> </span>migration<span class="w"> </span>to<span class="w"> </span><span class="m">54321</span>.<span class="w"> </span>Proceed?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span>?<span class="w"> </span>y
Creating<span class="w"> </span>new<span class="w"> </span>version<span class="w"> </span><span class="k">for</span><span class="w"> </span>file<span class="w"> </span>entity<span class="w"> </span>syn888
Creating<span class="w"> </span>new<span class="w"> </span>version<span class="w"> </span><span class="k">for</span><span class="w"> </span>file<span class="w"> </span>entity<span class="w"> </span>syn999
Completed<span class="w"> </span>migration<span class="w"> </span>of<span class="w"> </span>syn123.<span class="w"> </span><span class="m">2</span><span class="w"> </span>files<span class="w"> </span>migrated.<span class="w"> </span><span class="m">0</span><span class="w"> </span>errors<span class="w"> </span>encountered
Writing<span class="w"> </span>csv<span class="w"> </span>log<span class="w"> </span>to<span class="w"> </span>/tmp/migrate.csv
</code></pre></div>
<h2 id="sts-storage-locations">STS Storage Locations<a class="headerlink" href="#sts-storage-locations" title="Permanent link">&para;</a></h2>
<p>Create an STS enabled folder to use <a href="https://help.synapse.org/docs/Compute-Directly-on-Data-in-Synapse-or-S3.2048426057.html#ComputeDirectlyonDatainSynapseorS3-Synapse-ManagedSTSStorageLocations">AWS Security Token Service</a> credentials with S3 storage locations. These credentials can be scoped to access individual Synapse files or folders and can be used with external S3 tools such as the awscli and the boto3 library separately from Synapse to read and write files to and from Synapse storage. At this time read and write capabilities are supported for external storage locations, while default Synapse storage is limited to read only. Please read the linked documentation for a complete understanding of the capabilities and restrictions of STS enabled folders.</p>
<h3 id="creating-an-sts-enabled-folder">Creating an STS enabled folder<a class="headerlink" href="#creating-an-sts-enabled-folder" title="Permanent link">&para;</a></h3>
<p>Creating an STS enabled folder is similar to creating an external storage folder as described above, but this time passing an additional <strong>sts_enabled=True</strong> keyword parameter. The <strong>bucket_name</strong> and <strong>base_key</strong> parameters apply to external storage locations and can be omitted to use Synapse internal storage. Note also that STS can only be enabled on an empty folder.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># create a new folder to use with STS and external S3 storage</span>
<span class="n">folder</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Folder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">folder_name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">))</span>
<span class="n">folder</span><span class="p">,</span> <span class="n">storage_location</span><span class="p">,</span> <span class="n">project_setting</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">create_s3_storage_location</span><span class="p">(</span>
    <span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">,</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="s1">&#39;my-external-synapse-bucket&#39;</span><span class="p">,</span>
    <span class="n">base_key</span><span class="o">=</span><span class="s1">&#39;path/within/bucket&#39;</span><span class="p">,</span>
    <span class="n">sts_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="using-credentials-with-the-awscli">Using credentials with the awscli<a class="headerlink" href="#using-credentials-with-the-awscli" title="Permanent link">&para;</a></h3>
<p>This example illustrates obtaining STS credentials and using them with the awscli command line tool. The first command outputs the credentials as shell commands to execute which will then be picked up by subsequent aws cli commands. Note that the bucket-owner-full-control ACL is required when putting an object via STS credentials. This ensures that the object ownership will be transferred to the owner of the AWS bucket.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>synapse<span class="w"> </span>get-sts-token<span class="w"> </span>-o<span class="w"> </span>shell<span class="w"> </span>syn123<span class="w"> </span>read_write

<span class="nb">export</span><span class="w"> </span><span class="nv">SYNAPSE_STS_S3_LOCATION</span><span class="o">=</span><span class="s2">&quot;s3://my-external-synapse-bucket/path/within/bucket&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">&quot;&lt;access_key_id&gt;&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;&lt;secret_access_key&gt;&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SESSION_TOKEN</span><span class="o">=</span><span class="s2">&quot;&lt;session_token&gt;</span>

<span class="s2"># if the above are executed in the shell, the awscli will automatically apply them</span>

<span class="s2"># e.g. copy a file directly to the bucket using the exported credentials</span>
$<span class="s2"> aws s3 cp /path/to/local/file </span><span class="nv">$SYNAPSE_STS_S3_LOCATION</span><span class="s2"> --acl bucket-owner-full-control</span>
</code></pre></div>
<h3 id="using-credentials-with-boto3-in-python">Using credentials with boto3 in python<a class="headerlink" href="#using-credentials-with-boto3-in-python" title="Permanent link">&para;</a></h3>
<p>This example illustrates retrieving STS credentials and using them with boto3 within python code, in this case to upload a file.  Note that the bucket-owner-full-control ACL is required when putting an object via STS credentials. This ensures that the object ownership will be transferred to the owner of the AWS bucket.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># the boto output_format is compatible with the boto3 session api.</span>
<span class="n">credentials</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get_sts_storage_token</span><span class="p">(</span><span class="s1">&#39;syn123&#39;</span><span class="p">,</span> <span class="s1">&#39;read_write&#39;</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;boto&#39;</span><span class="p">)</span>

<span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
<span class="n">s3_client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
    <span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;/path/to/local/file,</span>
    <span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;my-external-synapse-bucket&#39;</span><span class="p">,</span>
    <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;path/within/bucket/file&#39;</span><span class="p">,</span>
    <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ACL&#39;</span><span class="p">:</span> <span class="s1">&#39;bucket-owner-full-control&#39;</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="automatic-transfers-tofrom-sts-storage-locations-using-boto3-with-synapseclient">Automatic transfers to/from STS storage locations using boto3 with synapseclient<a class="headerlink" href="#automatic-transfers-tofrom-sts-storage-locations-using-boto3-with-synapseclient" title="Permanent link">&para;</a></h3>
<p>The Python Synapse client can be configured to automatically use STS tokens to perform uploads and downloads to enabled storage locations using an installed boto3 library rather than through the traditional Synapse client APIs. This can improve performance in certain situations, particularly uploads of large files, as the data transfer itself can be conducted purely against the AWS S3 APIs, only invoking the Synapse APIs to retrieve the necessary token and to update Synapse metadata in the case of an upload. Once configured to do so, retrieval of STS tokens for supported operations occurs automatically without any change in synapseclient usage.</p>
<p>To enable STS/boto3 transfers on all <code>get</code> and <code>store</code> operations, do the following:</p>
<ol>
<li>Ensure that boto3 is installed in the same Python installation as synapseclient.</li>
</ol>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>boto3
</code></pre></div>
<ol>
<li>To enable automatic transfers on all uploads and downloads, update your Synapse client configuration file (typically .synapseConfig in your $HOME directory, unless otherwise configured) with the [transfer] section, if it is not already present. To leverage STS/boto3 transfers on a per Synapse client object basis, set the <strong>use_boto_sts_transfers</strong> property.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># add to .synapseConfig to automatically apply as default for all synapse client instances</span>
<span class="p">[</span><span class="n">transfer</span><span class="p">]</span>
<span class="n">use_boto_sts</span><span class="o">=</span><span class="n">true</span>

<span class="c1"># alternatively set on a per instance basis within python code</span>
<span class="n">syn</span><span class="o">.</span><span class="n">use_boto_sts_transfers</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<p>Note that if boto3 is not installed, then these settings will have no effect.</p>
<h2 id="sftp">SFTP<a class="headerlink" href="#sftp" title="Permanent link">&para;</a></h2>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h3>
<p>Installing the extra libraries that the Python client uses to communicate with SFTP servers may add a few steps to the installation process.</p>
<p>The required libraries are:</p>
<ul>
<li><a href="https://pypi.python.org/pypi/pysftp">pysftp</a></li>
<li><a href="http://www.paramiko.org/">paramiko</a></li>
<li><a href="https://www.dlitz.net/software/pycrypto/">pycrypto</a></li>
<li><a href="https://pypi.python.org/pypi/ecdsa/">ecdsa</a></li>
</ul>
<h4 id="installing-on-unix-variants">Installing on Unix variants<a class="headerlink" href="#installing-on-unix-variants" title="Permanent link">&para;</a></h4>
<p>Building these libraries on Unix OS's is straightforward, but you need the Python development headers and libraries. For example, in Debian or Ubuntu distributions:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>python-dev
</code></pre></div>
<p>Once this requirement is met, <code>sudo pip install synapseclient</code> should be able to build pycrypto.</p>
<h4 id="installing-on-windows">Installing on Windows<a class="headerlink" href="#installing-on-windows" title="Permanent link">&para;</a></h4>
<p><a href="http://www.voidspace.org.uk/python/modules.shtml#pycrypto">Binary distributions of pycrypto</a> built for Windows is available from Michael Foord at Voidspace. Install this before installing the Python client.</p>
<p>After running the pycrypto installer, <code>sudo pip install synapseclient</code> should work.</p>
<p>Another option is to build your own binary with either the <a href="http://www.visualstudio.com/en-us/products/visual-studio-community-vs">free developer tools from Microsoft</a> or the <a href="http://www.mingw.org/">MinGW compiler</a>.</p>
<h3 id="configure-your-client">Configure your client<a class="headerlink" href="#configure-your-client" title="Permanent link">&para;</a></h3>
<p>Make sure you configure your <a href="../../tutorials/authentication/#use-synapseconfig">~/.synapseConfig</a> file to connect to your SFTP server.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../views/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Using Entity Views">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Using Entity Views
              </div>
            </div>
          </a>
        
        
          
          <a href="../accessing_the_rest_api/" class="md-footer__link md-footer__link--next" aria-label="Next: Access the REST API">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Access the REST API
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Sage-Bionetworks/synapsePythonClient/pkgs/container/synapsepythonclient" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/synapseclient/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.footer", "navigation.sections", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../termynal.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>