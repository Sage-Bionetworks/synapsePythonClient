<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Synapse Utils &mdash; Synapse Python Client 3.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Validate Annotations" href="validate_annotations.html" />
    <link rel="prev" title="Data Storage" href="data_storage.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="../index.html">

              <img src="../_static/synapse_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/credentials.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/basics.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Articles</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_storage.html">Data Storage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Synapse Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.copy_functions">copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.walk_functions">walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.sync">sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.monitor">monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.migrate_functions">migrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-synapseutils.describe_functions">describe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="validate_annotations.html">Validate Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Accessing the API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/Client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Entity.html">Entity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Evaluation.html">Evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Activity.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Wiki.html">Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Table.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Team.html">Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/JsonSchema.html">JSON Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core.html">Core</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">News</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Synapse Python Client</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Synapse Utils</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/articles/synapseutils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="module-synapseutils">
<span id="synapse-utils"></span><h1>Synapse Utils<a class="headerlink" href="#module-synapseutils" title="Permalink to this headline"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">synapseutils</span></code> package provides both higher level beta functions as well as utilities for interacting with
<a class="reference external" href="http://www.synapse.org">Synapse</a>.  The behavior of these functions are subject to change.
These functionalities include:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#synapseutils.copy_functions.copy" title="synapseutils.copy_functions.copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_functions.copy()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.copy_functions.copyWiki" title="synapseutils.copy_functions.copyWiki"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_functions.copyWiki()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.walk_functions.walk" title="synapseutils.walk_functions.walk"><code class="xref py py-func docutils literal notranslate"><span class="pre">walk_functions.walk()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.sync.syncFromSynapse" title="synapseutils.sync.syncFromSynapse"><code class="xref py py-func docutils literal notranslate"><span class="pre">sync.syncFromSynapse()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.sync.syncToSynapse" title="synapseutils.sync.syncToSynapse"><code class="xref py py-func docutils literal notranslate"><span class="pre">sync.syncToSynapse()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.monitor.notifyMe" title="synapseutils.monitor.notifyMe"><code class="xref py py-func docutils literal notranslate"><span class="pre">monitor.notifyMe()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.migrate_functions.index_files_for_migration" title="synapseutils.migrate_functions.index_files_for_migration"><code class="xref py py-func docutils literal notranslate"><span class="pre">migrate_functions.index_files_for_migration()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.migrate_functions.migrate_indexed_files" title="synapseutils.migrate_functions.migrate_indexed_files"><code class="xref py py-func docutils literal notranslate"><span class="pre">migrate_functions.migrate_indexed_files()</span></code></a></p></li>
<li><p><a class="reference internal" href="#synapseutils.describe_functions.describe" title="synapseutils.describe_functions.describe"><code class="xref py py-func docutils literal notranslate"><span class="pre">describe_functions.describe()</span></code></a></p></li>
</ul>
</section>
<section id="module-synapseutils.copy_functions">
<span id="copy"></span><h2>copy<a class="headerlink" href="#module-synapseutils.copy_functions" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.copy_functions.changeFileMetaData">
<span class="sig-prename descclassname"><span class="pre">synapseutils.copy_functions.</span></span><span class="sig-name descname"><span class="pre">changeFileMetaData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downloadAs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contentType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forceVersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.copy_functions.changeFileMetaData" title="Permalink to this definition"></a></dt>
<dd><p>Change File Entity metadata like the download as name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – Synapse connection</p></li>
<li><p><strong>entity</strong> – Synapse entity Id or object</p></li>
<li><p><strong>contentType</strong> – Specify content type to change the content type of a filehandle</p></li>
<li><p><strong>downloadAs</strong> – Specify filename to change the filename of a filehandle</p></li>
<li><p><strong>forceVersion</strong> – Indicates whether the method should increment the version of
the object even if nothing has changed.  Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Synapse Entity</p>
</dd>
</dl>
<p>Can be used to change the filename or the file content-type without downloading:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file_entity</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">synid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_entity</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>  <span class="c1">## prints, e.g., &quot;my_file.txt&quot;</span>
<span class="n">file_entity</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="o">.</span><span class="n">changeFileMetaData</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">file_entity</span><span class="p">,</span> <span class="s2">&quot;my_new_name_file.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.copy_functions.copy">
<span class="sig-prename descclassname"><span class="pre">synapseutils.copy_functions.</span></span><span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destinationId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipCopyWikiPage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipCopyAnnotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.copy_functions.copy" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>This function will assist users in copying entities (Tables, Links, Files, Folders, Projects),
and will recursively copy everything in directories.</p></li>
<li><p>A Mapping of the old entities to the new entities will be created and all the wikis of each entity
will also be copied over and links to synapse Ids will be updated.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object: syn = synapseclient.login()- Must be logged into synapse</p></li>
<li><p><strong>entity</strong> – A synapse entity ID</p></li>
<li><p><strong>destinationId</strong> – Synapse ID of a folder/project that the copied entity is being copied to</p></li>
<li><p><strong>skipCopyWikiPage</strong> – Skip copying the wiki pages
Default is False</p></li>
<li><p><strong>skipCopyAnnotations</strong> – Skips copying the annotations
Default is False</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">synapseutils</span>
<span class="kn">import</span> <span class="nn">synapseclient</span>
<span class="n">syn</span> <span class="o">=</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
<span class="n">synapseutils</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Examples and extra parameters unique to each copy function
– COPYING FILES</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>version</strong> – Can specify version of a file.
Default to None</p></li>
<li><p><strong>updateExisting</strong> – When the destination has an entity that has the same name,
users can choose to update that entity.
It must be the same entity type
Default to False</p></li>
<li><p><strong>setProvenance</strong> – Has three values to set the provenance of the copied entity:
traceback: Sets to the source entity
existing: Sets to source entity’s original provenance (if it exists)
None: No provenance is set</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">synapseutils</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s2">&quot;syn12345&quot;</span><span class="p">,</span> <span class="s2">&quot;syn45678&quot;</span><span class="p">,</span> <span class="n">updateExisting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">setProvenance</span> <span class="o">=</span> <span class="s2">&quot;traceback&quot;</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>– COPYING FOLDERS/PROJECTS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>excludeTypes</strong> – Accepts a list of entity types (file, table, link) which determines which entity types to
not copy.
Defaults to an empty list.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#This will copy everything in the project into the destinationId except files and tables.</span>
<span class="n">synapseutils</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s2">&quot;syn123450&quot;</span><span class="p">,</span><span class="s2">&quot;syn345678&quot;</span><span class="p">,</span><span class="n">excludeTypes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="s2">&quot;table&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a mapping between the original and copied entity: {‘syn1234’:’syn33455’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.copy_functions.copyFileHandles">
<span class="sig-prename descclassname"><span class="pre">synapseutils.copy_functions.</span></span><span class="sig-name descname"><span class="pre">copyFileHandles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileHandles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">associateObjectTypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">associateObjectIds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newContentTypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newFileNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.copy_functions.copyFileHandles" title="Permalink to this definition"></a></dt>
<dd><p>Given a list of fileHandle Ids or Objects, copy the fileHandles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A Synapse object with user’s login, e.g. syn = synapseclient.login()</p></li>
<li><p><strong>fileHandles</strong> – List of fileHandle Ids or Objects</p></li>
<li><p><strong>associateObjectTypes</strong> – List of associated object types: FileEntity, TableEntity, WikiAttachment,
UserProfileAttachment, MessageAttachment, TeamAttachment, SubmissionAttachment,
VerificationSubmission (Must be the same length as fileHandles)</p></li>
<li><p><strong>associateObjectIds</strong> – List of associated object Ids: If copying a file, the objectId is the synapse id,
and if copying a wiki attachment, the object id is the wiki subpage id.
(Must be the same length as fileHandles)</p></li>
<li><p><strong>newContentTypes</strong> – (Optional) List of content types. Set each item to a new content type for each file
handle, or leave the item as None to keep the original content type. Default None,
which keeps all original content types.</p></li>
<li><p><strong>newFileNames</strong> – (Optional) List of filenames. Set each item to a new filename for each file handle,
or leave the item as None to keep the original name. Default None, which keeps all
original file names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of batch filehandle copy results, can include failureCodes: UNAUTHORIZED and
NOT_FOUND</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If length of all input arguments are not the same</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.copy_functions.copyWiki">
<span class="sig-prename descclassname"><span class="pre">synapseutils.copy_functions.</span></span><span class="sig-name descname"><span class="pre">copyWiki</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destinationId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entitySubPageId</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destinationSubPageId</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updateLinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updateSynIds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entityMap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.copy_functions.copyWiki" title="Permalink to this definition"></a></dt>
<dd><p>Copies wikis and updates internal links</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object: syn = synapseclient.login()- Must be logged into synapse</p></li>
<li><p><strong>entity</strong> – A synapse ID of an entity whose wiki you want to copy</p></li>
<li><p><strong>destinationId</strong> – Synapse ID of a folder/project that the wiki wants to be copied to</p></li>
<li><p><strong>updateLinks</strong> – Update all the internal links. (e.g. syn1234/wiki/34345 becomes syn3345/wiki/49508)
Defaults to True</p></li>
<li><p><strong>updateSynIds</strong> – Update all the synapse ID’s referenced in the wikis. (e.g. syn1234 becomes syn2345)
Defaults to True but needs an entityMap</p></li>
<li><p><strong>entityMap</strong> – An entity map {‘oldSynId’,’newSynId’} to update the synapse IDs referenced in the
wiki.
Defaults to None</p></li>
<li><p><strong>entitySubPageId</strong> – Can specify subPageId and copy all of its subwikis
Defaults to None, which copies the entire wiki subPageId can be found:
<a class="reference external" href="https://www.synapse.org/#!Synapse:syn123/wiki/1234">https://www.synapse.org/#!Synapse:syn123/wiki/1234</a>
In this case, 1234 is the subPageId.</p></li>
<li><p><strong>destinationSubPageId</strong> – Can specify destination subPageId to copy wikis to
Defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of Objects with three fields: id, title and parentId.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-synapseutils.walk_functions">
<span id="walk"></span><h2>walk<a class="headerlink" href="#module-synapseutils.walk_functions" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.walk_functions.walk">
<span class="sig-prename descclassname"><span class="pre">synapseutils.walk_functions.</span></span><span class="sig-name descname"><span class="pre">walk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includeTypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['folder',</span> <span class="pre">'file',</span> <span class="pre">'table',</span> <span class="pre">'link',</span> <span class="pre">'entityview',</span> <span class="pre">'dockerrepo',</span> <span class="pre">'submissionview',</span> <span class="pre">'dataset',</span> <span class="pre">'materializedview']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.walk_functions.walk" title="Permalink to this definition"></a></dt>
<dd><p>Traverse through the hierarchy of files and folders stored under the synId. Has the same behavior as os.walk()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object: syn = synapseclient.login()- Must be logged into synapse</p></li>
<li><p><strong>synId</strong> – A synapse ID of a folder or project</p></li>
<li><p><strong>includeTypes</strong> – Must be a list of entity types (ie. [“file”, “table”]) which can be found here:
<a class="reference external" href="http://rest-docs.synapse.org/rest/org/sagebionetworks/repo/model/EntityType.html">http://rest-docs.synapse.org/rest/org/sagebionetworks/repo/model/EntityType.html</a>
The “folder” type is always included so the hierarchy can be traversed</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">walkedPath</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s2">&quot;syn1234&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span> <span class="c1">#Exclude tables and views</span>

<span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">walkedPath</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span> <span class="c1">#All the folders in the directory path</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="c1">#All the files in the directory path</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-synapseutils.sync">
<span id="sync"></span><h2>sync<a class="headerlink" href="#module-synapseutils.sync" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.sync.generateManifest">
<span class="sig-prename descclassname"><span class="pre">synapseutils.sync.</span></span><span class="sig-name descname"><span class="pre">generateManifest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allFiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provenance_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.sync.generateManifest" title="Permalink to this definition"></a></dt>
<dd><p>Generates a manifest file based on a list of entities objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object as obtained with syn = synapseclient.login()</p></li>
<li><p><strong>allFiles</strong> – A list of File Entity objects on Synapse (can’t be Synapse IDs)</p></li>
<li><p><strong>filename</strong> – file where manifest will be written</p></li>
<li><p><strong>provenance_cache</strong> – an optional dict of known provenance dicts keyed by entity ids</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.sync.generate_sync_manifest">
<span class="sig-prename descclassname"><span class="pre">synapseutils.sync.</span></span><span class="sig-name descname"><span class="pre">generate_sync_manifest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.sync.generate_sync_manifest" title="Permalink to this definition"></a></dt>
<dd><p>Generate manifest for syncToSynapse() from a local directory.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.sync.readManifestFile">
<span class="sig-prename descclassname"><span class="pre">synapseutils.sync.</span></span><span class="sig-name descname"><span class="pre">readManifestFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifestFile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.sync.readManifestFile" title="Permalink to this definition"></a></dt>
<dd><p>Verifies a file manifest and returns a reordered dataframe ready for upload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object as obtained with syn = synapseclient.login()</p></li>
<li><p><strong>manifestFile</strong> – A tsv file with file locations and metadata to be pushed to Synapse.
See below for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas dataframe if the manifest is validated.</p>
</dd>
</dl>
<dl class="simple">
<dt>See also for a description of the file format:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#synapseutils.sync.syncToSynapse" title="synapseutils.sync.syncToSynapse"><code class="xref py py-func docutils literal notranslate"><span class="pre">synapseutils.sync.syncToSynapse()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.sync.syncFromSynapse">
<span class="sig-prename descclassname"><span class="pre">synapseutils.sync.</span></span><span class="sig-name descname"><span class="pre">syncFromSynapse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifcollision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'overwrite.local'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allFiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">followLink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downloadFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.sync.syncFromSynapse" title="Permalink to this definition"></a></dt>
<dd><p>Synchronizes all the files in a folder (including subfolders) from Synapse and adds a readme manifest with file
metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object as obtained with syn = synapseclient.login()</p></li>
<li><p><strong>entity</strong> – A Synapse ID, a Synapse Entity object of type file, folder or project.</p></li>
<li><p><strong>path</strong> – An optional path where the file hierarchy will be reproduced. If not specified the files will by
default be placed in the synapseCache.</p></li>
<li><p><strong>ifcollision</strong> – Determines how to handle file collisions. Maybe “overwrite.local”, “keep.local”, or “keep.both”.
Defaults to “overwrite.local”.</p></li>
<li><p><strong>followLink</strong> – Determines whether the link returns the target Entity.
Defaults to False</p></li>
<li><p><strong>manifest</strong> – Determines whether creating manifest file automatically.
The optional values here (“all”, “root”, “suppress”).</p></li>
<li><p><strong>downloadFile</strong> – Determines whether downloading the files.
Defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of entities (files, tables, links)</p>
</dd>
</dl>
<p>This function will crawl all subfolders of the project/folder specified by <cite>entity</cite> and download all files that have
not already been downloaded.  If there are newer files in Synapse (or a local file has been edited outside of the
cache) since the last download then local the file will be replaced by the new file unless “ifcollision” is changed.</p>
<p>If the files are being downloaded to a specific location outside of the Synapse cache a file
(SYNAPSE_METADATA_MANIFEST.tsv) will also be added in the path that contains the metadata (annotations, storage
location and provenance of all downloaded files).</p>
<p>See also:
- <a class="reference internal" href="#synapseutils.sync.syncToSynapse" title="synapseutils.sync.syncToSynapse"><code class="xref py py-func docutils literal notranslate"><span class="pre">synapseutils.sync.syncToSynapse()</span></code></a></p>
<p>Example - Download and print the paths of all downloaded files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">entities</span> <span class="o">=</span> <span class="n">syncFromSynapse</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s2">&quot;syn1234&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.sync.syncToSynapse">
<span class="sig-prename descclassname"><span class="pre">synapseutils.sync.</span></span><span class="sig-name descname"><span class="pre">syncToSynapse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifestFile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryRun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sendMessages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.sync.syncToSynapse" title="Permalink to this definition"></a></dt>
<dd><p>Synchronizes files specified in the manifest file to Synapse</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object as obtained with syn = synapseclient.login()</p></li>
<li><p><strong>manifestFile</strong> – A tsv file with file locations and metadata to be pushed to Synapse.
See below for details</p></li>
<li><p><strong>dryRun</strong> – Performs validation without uploading if set to True (default is False)</p></li>
</ul>
</dd>
</dl>
<p>Given a file describing all of the uploads uploads the content to Synapse and optionally notifies you via Synapse
messagging (email) at specific intervals, on errors and on completion.</p>
<p><strong>Manifest file format</strong></p>
<p>The format of the manifest file is a tab delimited file with one row per file to upload and columns describing the
file. The minimum required columns are <strong>path</strong> and <strong>parent</strong> where path is the local file path and parent is the
Synapse Id of the project or folder where the file is uploaded to. In addition to these columns you can specify any
of the parameters to the File constructor (<strong>name</strong>, <strong>synapseStore</strong>, <strong>contentType</strong>) as well as parameters to the
syn.store command (<strong>used</strong>, <strong>executed</strong>, <strong>activityName</strong>, <strong>activityDescription</strong>, <strong>forceVersion</strong>).  For only
updating annotations without uploading new versions of unchanged files, the syn.store parameter forceVersion
should be included in the manifest with the value set to False.
Used and executed can be semi-colon (“;”) separated lists of Synapse ids, urls and/or local filepaths of files
already stored in Synapse (or being stored in Synapse by the manifest).  If you leave a space, like
“syn1234; syn2345” the white space from ” syn2345” will be stripped.
Any additional columns will be added as annotations.</p>
<p><strong>Required fields:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 39%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>path</p></td>
<td><p>local file path or URL</p></td>
<td><p>/path/to/local/file.txt</p></td>
</tr>
<tr class="row-odd"><td><p>parent</p></td>
<td><p>synapse id</p></td>
<td><p>syn1235</p></td>
</tr>
</tbody>
</table>
<p><strong>Common fields:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 50%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>name of file in Synapse</p></td>
<td><p>Example_file</p></td>
</tr>
<tr class="row-odd"><td><p>forceVersion</p></td>
<td><p>whether to update version</p></td>
<td><p>False</p></td>
</tr>
</tbody>
</table>
<p><strong>Provenance fields:</strong></p>
<p>Each of these are individual examples and is what you would find in a row in each of these columns. To
clarify, “syn1235;/path/to_local/file.txt” below states that you would like both
“syn1234” and “/path/to_local/file.txt” added as items used to generate a file. You can also specify one item
by specifying “syn1234”</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 37%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>used</p></td>
<td><p>List of items used to generate file</p></td>
<td><p>“syn1235;/path/to_local/file.txt”</p></td>
</tr>
<tr class="row-odd"><td><p>executed</p></td>
<td><p>List of items exectued</p></td>
<td><p>“<a class="reference external" href="https://github.org/;/path/to_local/code.py">https://github.org/;/path/to_local/code.py</a>”</p></td>
</tr>
<tr class="row-even"><td><p>activityName</p></td>
<td><p>Name of activity in provenance</p></td>
<td><p>“Ran normalization”</p></td>
</tr>
<tr class="row-odd"><td><p>activityDescription</p></td>
<td><p>Text description on what was done</p></td>
<td><p>“Ran algorithm xyx with parameters…”</p></td>
</tr>
</tbody>
</table>
<p>Annotations:</p>
<p><strong>Annotations:</strong></p>
<p>Any columns that are not in the reserved names described above will be interpreted as annotations of the file</p>
<p><strong>Other optional fields:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 61%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>synapseStore</p></td>
<td><p>Boolean describing whether to upload files</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>contentType</p></td>
<td><p>content type of file to overload defaults</p></td>
<td><p>text/html</p></td>
</tr>
</tbody>
</table>
<p><strong>Example manifest file</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 29%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>path</p></th>
<th class="head"><p>parent</p></th>
<th class="head"><p>annot1</p></th>
<th class="head"><p>annot2</p></th>
<th class="head"><p>used</p></th>
<th class="head"><p>executed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/path/file1.txt</p></td>
<td><p>syn1243</p></td>
<td><p>“bar”</p></td>
<td><p>3.1415</p></td>
<td><p>“syn124;/path/file2.txt”</p></td>
<td><p>“<a class="reference external" href="https://github.org/foo/bar">https://github.org/foo/bar</a>”</p></td>
</tr>
<tr class="row-odd"><td><p>/path/file2.txt</p></td>
<td><p>syn12433</p></td>
<td><p>“baz”</p></td>
<td><p>2.71</p></td>
<td><p>“”</p></td>
<td><p>“<a class="reference external" href="https://github.org/foo/baz">https://github.org/foo/baz</a>”</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>
<section id="module-synapseutils.monitor">
<span id="monitor"></span><h2>monitor<a class="headerlink" href="#module-synapseutils.monitor" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.monitor.notifyMe">
<span class="sig-prename descclassname"><span class="pre">synapseutils.monitor.</span></span><span class="sig-name descname"><span class="pre">notifyMe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">messageSubject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.monitor.notifyMe" title="Permalink to this definition"></a></dt>
<dd><p>Function decorator that notifies you via email whenever an function completes running or there is a failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A synapse object as obtained with syn = synapseclient.login()</p></li>
<li><p><strong>messageSubject</strong> – A string with subject line for sent out messages.</p></li>
<li><p><strong>retries</strong> – Number of retries to attempt on failure (default=0)</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># to decorate a function that you define</span>
<span class="kn">from</span> <span class="nn">synapseutils</span> <span class="kn">import</span> <span class="n">notifyMe</span>
<span class="kn">import</span> <span class="nn">synapseclient</span>
<span class="n">syn</span> <span class="o">=</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>

<span class="nd">@notifyMe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s1">&#39;Long running function&#39;</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">doing_something</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">long_runtime_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">my_function</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># to wrap a function that already exists</span>
<span class="kn">from</span> <span class="nn">synapseutils</span> <span class="kn">import</span> <span class="n">notifyMe</span>
<span class="kn">import</span> <span class="nn">synapseclient</span>
<span class="n">syn</span> <span class="o">=</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>

<span class="n">notify_decorator</span> <span class="o">=</span> <span class="n">notifyMe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s1">&#39;Long running query&#39;</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">my_query</span> <span class="o">=</span> <span class="n">notify_decorator</span><span class="p">(</span><span class="n">syn</span><span class="o">.</span><span class="n">tableQuery</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">my_query</span><span class="p">(</span><span class="s2">&quot;select id from syn1223&quot;</span><span class="p">)</span>

<span class="c1">#############################</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.monitor.with_progress_bar">
<span class="sig-prename descclassname"><span class="pre">synapseutils.monitor.</span></span><span class="sig-name descname"><span class="pre">with_progress_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">totalCalls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isBytes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.monitor.with_progress_bar" title="Permalink to this definition"></a></dt>
<dd><p>Wraps a function to add a progress bar based on the number of calls to that function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – Function being wrapped with progress Bar</p></li>
<li><p><strong>totalCalls</strong> – total number of items/bytes when completed</p></li>
<li><p><strong>prefix</strong> – String printed before progress bar</p></li>
<li><p><strong>prefix</strong> – String printed after progress bar</p></li>
<li><p><strong>isBytes</strong> – A boolean indicating weather to convert bytes to kB, MB, GB etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a wrapped function that contains a progress bar</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-synapseutils.migrate_functions">
<span id="migrate"></span><h2>migrate<a class="headerlink" href="#module-synapseutils.migrate_functions" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.MigrationResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">synapseutils.migrate_functions.</span></span><span class="sig-name descname"><span class="pre">MigrationResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.MigrationResult" title="Permalink to this definition"></a></dt>
<dd><p>A MigrationResult is a proxy object to the underlying sqlite db.
It provides a programmatic interface that allows the caller to iterate over the
file handles that were migrated without having to connect to or know the schema
of the sqlite db, and also avoids the potential memory liability of putting
everything into an in memory data structure that could be a liability when
migrating a huge project of hundreds of thousands/millions of entities.</p>
<p>As this proxy object is not thread safe since it accesses an underlying sqlite db.</p>
<dl class="py method">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.MigrationResult.as_csv">
<span class="sig-name descname"><span class="pre">as_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.MigrationResult.as_csv" title="Permalink to this definition"></a></dt>
<dd><p>Output a flat csv file of the contents of the Migration index.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>csv file with columns as follows:</p>
<ul class="simple">
<li><p>id - the Synapse id</p></li>
<li><p>type - the concrete type of the entity</p></li>
<li><p>version - the verson of the file entity (if applicable)</p></li>
<li><p>row_id - the row of the table attached file (if applicable)</p></li>
<li><p>col_name - the column name of the column the table attached file resides in (if applicable)</p></li>
<li><p>from_storage_location_id - the previous storage location id where the file/version was stored</p></li>
<li><p>from_file_handle_id - the id file handle of the existing file/version</p></li>
<li><p>to_file_handle_id - if migrated, the new file handle id</p></li>
<li><p>status - one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</p></li>
<li><p>exception - if an error was encountered indexing/migrating the file/version its stack is here</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.MigrationResult.get_counts_by_status">
<span class="sig-name descname"><span class="pre">get_counts_by_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.MigrationResult.get_counts_by_status" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of counts by the migration status of each indexed file/version.
Keys are as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>INDEXED - the file/version has been indexed and will be migrated on a call to migrate_indexed_files</p></li>
<li><p>MIGRATED - the file/version has been migrated</p></li>
<li><p>ALREADY_MIGRATED - the file/version was already stored at the target storage location and no migration is needed</p></li>
<li><p>ERRORED - an error occurred while indexing or migrating the file/version</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.MigrationResult.get_migrations">
<span class="sig-name descname"><span class="pre">get_migrations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.MigrationResult.get_migrations" title="Permalink to this definition"></a></dt>
<dd><p>A generator yielding each file/version in the migration index.</p>
<dl class="field-list simple">
<dt class="field-odd">Yeild</dt>
<dd class="field-odd"><p>A dictionary of the properties of the migration row is yielded as follows:</p>
<ul class="simple">
<li><p>id: the Synapse id</p></li>
<li><p>type: the concrete type of the entity</p></li>
<li><p>version: the verson of the file entity (if applicable)</p></li>
<li><p>row_id: the row of the table attached file (if applicable)</p></li>
<li><p>col_id: the column id of the table attached file (if applicable)</p></li>
<li><p>from_storage_location_id: - the previous storage location id where the file/version was stored</p></li>
<li><p>from_file_handle_id: the id file handle of the existing file/version</p></li>
<li><p>to_file_handle_id: if migrated, the new file handle id</p></li>
<li><p>status: one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</p></li>
<li><p>exception: if an error was encountered indexing/migrating the file/version its stack is here</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.index_files_for_migration">
<span class="sig-prename descclassname"><span class="pre">synapseutils.migrate_functions.</span></span><span class="sig-name descname"><span class="pre">index_files_for_migration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/Client.html#synapseclient.Synapse" title="synapseclient.client.Synapse"><span class="pre">synapseclient.client.Synapse</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_storage_location_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_storage_location_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_version_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_table_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.index_files_for_migration" title="Permalink to this definition"></a></dt>
<dd><p>Index the given entity for migration to a new storage location. This is the first step in migrating an entity
to a new storage location using synapseutils.</p>
<p>This function will create a sqlite database at the given db_path that can be subsequently passed
to the migrate_indexed_files function for actual migration. This function itself does not modify the given entity
in any way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A Synapse object with user’s login, e.g. syn = synapseclient.login()</p></li>
<li><p><strong>entity</strong> – A Synapse entity whose files should be migrated. Can be a Project, Folder,
File entity, or Table entity. If it is a container (a Project or Folder) its
contents will be recursively indexed.</p></li>
<li><p><strong>dest_storage_location_id</strong> – The id of the new storage location to be migrated to.</p></li>
<li><p><strong>db_path</strong> – A path on disk where a sqlite db can be created to store the contents of the
created index.</p></li>
<li><p><strong>source_storage_location_ids</strong> – An optional iterable of storage location ids that will be migrated. If provided,
files outside of one of the listed storage locations will not be indexed
for migration. If not provided, then all files not already in the destination
storage location will be indexed for migrated.</p></li>
<li><p><strong>file_version_strategy</strong> – <p>One of “new” (default), “all”, “latest”, “skip” as follows:</p>
<ul>
<li><p>”new” - will create a new version of file entities in the new storage location, leaving existing versions unchanged</p></li>
<li><p>”all” - all existing versions will be migrated in place to the new storage location</p></li>
<li><p>”latest” - the latest version will be migrated in place to the new storage location</p></li>
<li><p>”skip” - skip migrating file entities. use this e.g. if wanting to e.g. migrate table attached files in a container while leaving the files unchanged</p></li>
</ul>
</p></li>
<li><p><strong>include_table_files</strong> – Whether to migrate files attached to tables. If False (default) then e.g. only
file entities in the container will be migrated and tables will be untouched.</p></li>
<li><p><strong>continue_on_error</strong> – Whether any errors encountered while indexing an entity (access etc) will be raised
or instead just recorded in the index while allowing the index creation
to continue. Default is False (any errors are raised).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A MigrationResult object that can be used to inspect the contents of the index
or output the index to a CSV for manual inspection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.migrate_functions.migrate_indexed_files">
<span class="sig-prename descclassname"><span class="pre">synapseutils.migrate_functions.</span></span><span class="sig-name descname"><span class="pre">migrate_indexed_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/Client.html#synapseclient.Synapse" title="synapseclient.client.Synapse"><span class="pre">synapseclient.client.Synapse</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_table_snapshots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.migrate_functions.migrate_indexed_files" title="Permalink to this definition"></a></dt>
<dd><p>Migrate files previously indexed in a sqlite database at the given db_path using the separate
index_files_for_migration function. The files listed in the index will be migrated according to the
configuration of that index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – A Synapse object with user’s login, e.g. syn = synapseclient.login()</p></li>
<li><p><strong>db_path</strong> – A path on disk where a sqlite db was created using the index_files_for_migration
function.</p></li>
<li><p><strong>create_table_snapshots</strong> – When updating the files in any table, whether the a snapshot of the table is
first created (default True).</p></li>
<li><p><strong>continue_on_error</strong> – Whether any errors encountered while migrating will be raised
or instead just recorded in the sqlite database while allowing the migration
to continue. Default is False (any errors are raised).</p></li>
<li><p><strong>force</strong> – If running in an interactive shell, migration requires an interactice confirmation.
This can be bypassed by using the force=True option.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A MigrationResult object that can be used to inspect the results of the migration.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-synapseutils.describe_functions">
<span id="describe"></span><h2>describe<a class="headerlink" href="#module-synapseutils.describe_functions" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="synapseutils.describe_functions.describe">
<span class="sig-prename descclassname"><span class="pre">synapseutils.describe_functions.</span></span><span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#synapseutils.describe_functions.describe" title="Permalink to this definition"></a></dt>
<dd><p>Gets a synapse entity and returns summary statistics about it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>syn</strong> – synapse object</p></li>
<li><p><strong>entity</strong> – synapse id of the entity to be described</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">synapseclient</span>
<span class="kn">import</span> <span class="nn">synapseutils</span>
<span class="n">syn</span> <span class="o">=</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
<span class="n">statistics</span> <span class="o">=</span> <span class="n">synapseutils</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;syn123&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">&quot;column1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;FOOBAR&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;column2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">1.4</span>
    <span class="p">},</span>
    <span class="s2">&quot;column3&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.5</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>if dataset is valid, returns a dict; otherwise None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data_storage.html" class="btn btn-neutral float-left" title="Data Storage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="validate_annotations.html" class="btn btn-neutral float-right" title="Validate Annotations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2023, Sage Bionetworks.
      <span class="lastupdated">Last updated on Oct 23, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <div class="footer">
    &copy; <a href="http://sagebase.org/">Sage Bionetworks</a>.
      Last updated on Oct 23, 2023.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-44781812-1', 'synapse.org');
      ga('send', 'pageview');
    </script>

</body>
</html>
