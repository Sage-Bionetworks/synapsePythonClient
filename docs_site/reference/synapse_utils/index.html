
<!doctype html>
<html lang="en" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">

        <meta name="description" content="A Python client for Sage Bionetworks' Synapse, a collaborative, open-source research platform that allows teams to share data, track analyses, and collaborate. The Python client can be used as a library for development of software that communicates with Synapse or as a command-line utility.">


        <meta name="author" content="Bryan Fauble">



        <link rel="prev" href="../client/">


        <link rel="next" href="../entity/">


      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">



        <title>Synapse Utils - Synapse Python/Command Line Client Documentation</title>



      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">


        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">











  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');}</style>











        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>



      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">

      <link rel="stylesheet" href="../../css/custom.css">

      <link rel="stylesheet" href="../../termynal.css">

    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>






  </head>









    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">


    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">


        <a href="#synapse-utils" class="md-skip">
          Skip to content
        </a>

    </div>
    <div data-md-component="announce">

    </div>






<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Synapse Python/Command Line Client Documentation" class="md-header__button md-logo" aria-label="Synapse Python/Command Line Client Documentation" data-md-component="logo">

  <img src="../../assets/synapse_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Synapse Python/Command Line Client Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">

              Synapse Utils

          </span>
        </div>
      </div>
    </div>


        <form class="md-header__option" data-md-component="palette">




    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">

      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>





    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">

      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>


</form>



      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>



      <label class="md-header__button md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">

          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">

            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>

        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>

        <div class="md-search__suggest" data-md-component="search-suggest"></div>

    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>


      <div class="md-header__source">
        <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    synapsePythonClient
  </div>
</a>
      </div>

  </nav>



<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">





    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">




  Home

      </a>
    </li>









      <li class="md-tabs__item">
        <a href="../../tutorials/installation/" class="md-tabs__link">


  Tutorials

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../guides/views/" class="md-tabs__link">


  How-To Guides

        </a>
      </li>












      <li class="md-tabs__item md-tabs__item--active">
        <a href="../client/" class="md-tabs__link">


  API Reference

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../explanations/access_control/" class="md-tabs__link">


  Further Reading

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../news/" class="md-tabs__link">


  News

        </a>
      </li>




    </ul>
  </div>
</nav>


</header>

    <div class="md-container" data-md-component="container">




      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">



              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">






<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Synapse Python/Command Line Client Documentation" class="md-nav__button md-logo" aria-label="Synapse Python/Command Line Client Documentation" data-md-component="logo">

  <img src="../../assets/synapse_logo.png" alt="logo">

    </a>
    Synapse Python/Command Line Client Documentation
  </label>

    <div class="md-nav__source">
      <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    synapsePythonClient
  </div>
</a>
    </div>

  <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">


  <span class="md-ellipsis">
    Home
  </span>


      </a>
    </li>

















    <li class="md-nav__item md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >


          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">


  <span class="md-ellipsis">
    Tutorials
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../tutorials/installation/" class="md-nav__link">


  <span class="md-ellipsis">
    Installation
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/authentication/" class="md-nav__link">


  <span class="md-ellipsis">
    Authentication
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/configuration/" class="md-nav__link">


  <span class="md-ellipsis">
    Configuration
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/python_client/" class="md-nav__link">


  <span class="md-ellipsis">
    Working with the Python client
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/command_line_client/" class="md-nav__link">


  <span class="md-ellipsis">
    Working with the Command Line Client
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/file_versioning/" class="md-nav__link">


  <span class="md-ellipsis">
    Working with file versioning
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/tables/" class="md-nav__link">


  <span class="md-ellipsis">
    Working with tables
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../tutorials/reticulate/" class="md-nav__link">


  <span class="md-ellipsis">
    Synapseclient with R through reticulate
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>

















    <li class="md-nav__item md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >


          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">


  <span class="md-ellipsis">
    How-To Guides
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../guides/views/" class="md-nav__link">


  <span class="md-ellipsis">
    Using Entity Views
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../guides/data_storage/" class="md-nav__link">


  <span class="md-ellipsis">
    Data Storage
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../guides/accessing_the_rest_api/" class="md-nav__link">


  <span class="md-ellipsis">
    Access the REST API
  </span>


      </a>
    </li>


















    <li class="md-nav__item md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >


          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">


  <span class="md-ellipsis">
    Expermental Features
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Expermental Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../guides/validate_annotations/" class="md-nav__link">


  <span class="md-ellipsis">
    Validating Annotations
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>




          </ul>
        </nav>

    </li>



















    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>


          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">


  <span class="md-ellipsis">
    API Reference
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../client/" class="md-nav__link">


  <span class="md-ellipsis">
    Client
  </span>


      </a>
    </li>












    <li class="md-nav__item md-nav__item--active">

      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">





        <label class="md-nav__link md-nav__link--active" for="__toc">


  <span class="md-ellipsis">
    Synapse Utils
  </span>


          <span class="md-nav__icon md-icon"></span>
        </label>

      <a href="./" class="md-nav__link md-nav__link--active">


  <span class="md-ellipsis">
    Synapse Utils
  </span>


      </a>



<nav class="md-nav md-nav--secondary" aria-label="Table of contents">






    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>

        <li class="md-nav__item">
  <a href="#synapseutils" class="md-nav__link">
    <span class="md-ellipsis">
      synapseutils
    </span>
  </a>

    <nav class="md-nav" aria-label="synapseutils">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils--overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.sync" class="md-nav__link">
    <span class="md-ellipsis">
      sync
    </span>
  </a>

    <nav class="md-nav" aria-label="sync">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.sync-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.sync.syncFromSynapse" class="md-nav__link">
    <span class="md-ellipsis">
      syncFromSynapse()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.syncToSynapse" class="md-nav__link">
    <span class="md-ellipsis">
      syncToSynapse()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.generateManifest" class="md-nav__link">
    <span class="md-ellipsis">
      generateManifest()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.generate_sync_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      generate_sync_manifest()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.readManifestFile" class="md-nav__link">
    <span class="md-ellipsis">
      readManifestFile()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.copy_functions" class="md-nav__link">
    <span class="md-ellipsis">
      copy_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="copy_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.changeFileMetaData" class="md-nav__link">
    <span class="md-ellipsis">
      changeFileMetaData()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copyFileHandles" class="md-nav__link">
    <span class="md-ellipsis">
      copyFileHandles()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copyWiki" class="md-nav__link">
    <span class="md-ellipsis">
      copyWiki()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.walk_functions" class="md-nav__link">
    <span class="md-ellipsis">
      walk_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="walk_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.walk_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.walk_functions.walk" class="md-nav__link">
    <span class="md-ellipsis">
      walk()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.monitor" class="md-nav__link">
    <span class="md-ellipsis">
      monitor
    </span>
  </a>

    <nav class="md-nav" aria-label="monitor">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.monitor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.monitor.notifyMe" class="md-nav__link">
    <span class="md-ellipsis">
      notifyMe()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.monitor.with_progress_bar" class="md-nav__link">
    <span class="md-ellipsis">
      with_progress_bar()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions" class="md-nav__link">
    <span class="md-ellipsis">
      migrate_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="migrate_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>

    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult" class="md-nav__link">
    <span class="md-ellipsis">
      MigrationResult
    </span>
  </a>

    <nav class="md-nav" aria-label="MigrationResult">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.get_counts_by_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_counts_by_status()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.get_migrations" class="md-nav__link">
    <span class="md-ellipsis">
      get_migrations()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.as_csv" class="md-nav__link">
    <span class="md-ellipsis">
      as_csv()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.index_files_for_migration" class="md-nav__link">
    <span class="md-ellipsis">
      index_files_for_migration()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.migrate_indexed_files" class="md-nav__link">
    <span class="md-ellipsis">
      migrate_indexed_files()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.describe_functions" class="md-nav__link">
    <span class="md-ellipsis">
      describe_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="describe_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.describe_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.describe_functions.describe" class="md-nav__link">
    <span class="md-ellipsis">
      describe()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

    </ul>

</nav>

    </li>










    <li class="md-nav__item">
      <a href="../entity/" class="md-nav__link">


  <span class="md-ellipsis">
    Entity
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../project/" class="md-nav__link">


  <span class="md-ellipsis">
    Project
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../folder/" class="md-nav__link">


  <span class="md-ellipsis">
    Folder
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../file/" class="md-nav__link">


  <span class="md-ellipsis">
    File
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../annotations/" class="md-nav__link">


  <span class="md-ellipsis">
    Annotations
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">


  <span class="md-ellipsis">
    Tables
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../table_schema/" class="md-nav__link">


  <span class="md-ellipsis">
    Table Schema
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../view_schema/" class="md-nav__link">


  <span class="md-ellipsis">
    Entity View Schema
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../activity/" class="md-nav__link">


  <span class="md-ellipsis">
    Activity/Provenance
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../teams/" class="md-nav__link">


  <span class="md-ellipsis">
    Teams
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../wiki/" class="md-nav__link">


  <span class="md-ellipsis">
    Wiki
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">


  <span class="md-ellipsis">
    Evaluation
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../link/" class="md-nav__link">


  <span class="md-ellipsis">
    Link
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../docker_repository/" class="md-nav__link">


  <span class="md-ellipsis">
    DockerRepository
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../json_schema/" class="md-nav__link">


  <span class="md-ellipsis">
    JSON Schema
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">


  <span class="md-ellipsis">
    Exceptions
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">


  <span class="md-ellipsis">
    Core
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>

















    <li class="md-nav__item md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >


          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">


  <span class="md-ellipsis">
    Further Reading
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Further Reading
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../explanations/access_control/" class="md-nav__link">


  <span class="md-ellipsis">
    Access Control
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../explanations/properties_vs_annotations/" class="md-nav__link">


  <span class="md-ellipsis">
    Properties vs Annotations
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../explanations/manifest_tsv/" class="md-nav__link">


  <span class="md-ellipsis">
    Manifest TSV
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../explanations/benchmarking/" class="md-nav__link">


  <span class="md-ellipsis">
    Benchmarking
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>

















    <li class="md-nav__item md-nav__item--section md-nav__item--nested">




        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >


          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">


  <span class="md-ellipsis">
    News
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            News
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">


  <span class="md-ellipsis">
    Release Notes
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>



  </ul>
</nav>
                  </div>
                </div>
              </div>



              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">






    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>

        <li class="md-nav__item">
  <a href="#synapseutils" class="md-nav__link">
    <span class="md-ellipsis">
      synapseutils
    </span>
  </a>

    <nav class="md-nav" aria-label="synapseutils">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils--overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.sync" class="md-nav__link">
    <span class="md-ellipsis">
      sync
    </span>
  </a>

    <nav class="md-nav" aria-label="sync">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.sync-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.sync.syncFromSynapse" class="md-nav__link">
    <span class="md-ellipsis">
      syncFromSynapse()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.syncToSynapse" class="md-nav__link">
    <span class="md-ellipsis">
      syncToSynapse()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.generateManifest" class="md-nav__link">
    <span class="md-ellipsis">
      generateManifest()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.generate_sync_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      generate_sync_manifest()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.sync.readManifestFile" class="md-nav__link">
    <span class="md-ellipsis">
      readManifestFile()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.copy_functions" class="md-nav__link">
    <span class="md-ellipsis">
      copy_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="copy_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.changeFileMetaData" class="md-nav__link">
    <span class="md-ellipsis">
      changeFileMetaData()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copyFileHandles" class="md-nav__link">
    <span class="md-ellipsis">
      copyFileHandles()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.copy_functions.copyWiki" class="md-nav__link">
    <span class="md-ellipsis">
      copyWiki()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.walk_functions" class="md-nav__link">
    <span class="md-ellipsis">
      walk_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="walk_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.walk_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.walk_functions.walk" class="md-nav__link">
    <span class="md-ellipsis">
      walk()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.monitor" class="md-nav__link">
    <span class="md-ellipsis">
      monitor
    </span>
  </a>

    <nav class="md-nav" aria-label="monitor">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.monitor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.monitor.notifyMe" class="md-nav__link">
    <span class="md-ellipsis">
      notifyMe()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.monitor.with_progress_bar" class="md-nav__link">
    <span class="md-ellipsis">
      with_progress_bar()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions" class="md-nav__link">
    <span class="md-ellipsis">
      migrate_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="migrate_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>

    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult" class="md-nav__link">
    <span class="md-ellipsis">
      MigrationResult
    </span>
  </a>

    <nav class="md-nav" aria-label="MigrationResult">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.get_counts_by_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_counts_by_status()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.get_migrations" class="md-nav__link">
    <span class="md-ellipsis">
      get_migrations()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.MigrationResult.as_csv" class="md-nav__link">
    <span class="md-ellipsis">
      as_csv()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.index_files_for_migration" class="md-nav__link">
    <span class="md-ellipsis">
      index_files_for_migration()
    </span>
  </a>

</li>

          <li class="md-nav__item">
  <a href="#synapseutils.migrate_functions.migrate_indexed_files" class="md-nav__link">
    <span class="md-ellipsis">
      migrate_indexed_files()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#synapseutils.describe_functions" class="md-nav__link">
    <span class="md-ellipsis">
      describe_functions
    </span>
  </a>

    <nav class="md-nav" aria-label="describe_functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.describe_functions-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>

    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#synapseutils.describe_functions.describe" class="md-nav__link">
    <span class="md-ellipsis">
      describe()
    </span>
  </a>

</li>

      </ul>
    </nav>

</li>

      </ul>
    </nav>

</li>

    </ul>

</nav>
                  </div>
                </div>
              </div>



            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">







<h1 id="synapse-utils">Synapse Utils<a class="headerlink" href="#synapse-utils" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




<h2 id="synapseutils" class="doc doc-heading">
          <code>synapseutils</code>


<a href="#synapseutils" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">

      <h4 id="synapseutils--overview">Overview<a class="headerlink" href="#synapseutils--overview" title="Permanent link">&para;</a></h4>
<p>The <code>synapseutils</code> package provides both higher level beta functions as well as utilities for interacting with
<a href="http://www.synapse.org">Synapse</a>.  The behavior of these functions are subject to change.</p>



  <div class="doc doc-children">







<h3 id="synapseutils-functions">Functions<a href="#synapseutils-functions" class="headerlink" title="Permanent link">&para;</a></h3>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.sync" class="doc doc-heading">
          <code>synapseutils.sync</code>


<a href="#synapseutils.sync" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">







<h3 id="synapseutils.sync-functions">Functions<a href="#synapseutils.sync-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.sync.syncFromSynapse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">syncFromSynapse</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ifcollision</span><span class="o">=</span><span class="s1">&#39;overwrite.local&#39;</span><span class="p">,</span> <span class="n">allFiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">followLink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">manifest</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#synapseutils.sync.syncFromSynapse" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Synchronizes all the files in a folder (including subfolders) from Synapse and adds a readme manifest with file
metadata.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse ID, a Synapse Entity object of type file, folder or project.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An optional path where the file hierarchy will be reproduced. If not specified the files will by default be placed in the synapseCache.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ifcollision</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Determines how to handle file collisions. Maybe "overwrite.local", "keep.local", or "keep.both".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;overwrite.local&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>followLink</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Determines whether the link returns the target Entity.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>manifest</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Determines whether creating manifest file automatically. The optional values here (<code>all</code>, <code>root</code>, <code>suppress</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;all&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>downloadFile</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Determines whether downloading the files.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>List of entities (<a class="autorefs autorefs-internal" href="../file/#synapseclient.entity.File">files</a>, <a class="autorefs autorefs-internal" href="../tables/#synapseclient.table.Table">tables</a>, <a class="autorefs autorefs-internal" href="../link/#synapseclient.entity.Link">links</a>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>This function will crawl all subfolders of the project/folder specified by <code>entity</code> and download all files that have
not already been downloaded.  If there are newer files in Synapse (or a local file has been edited outside of the
cache) since the last download then local the file will be replaced by the new file unless "ifcollision" is changed.</p>
<p>If the files are being downloaded to a specific location outside of the Synapse cache a file
(SYNAPSE_METADATA_MANIFEST.tsv) will also be added in the path that contains the metadata (annotations, storage
location and provenance of all downloaded files).</p>
<p>See also:</p>
<ul>
<li><a class="autorefs autorefs-internal" href="#synapseutils.sync.syncToSynapse">synapseutils.sync.syncToSynapse</a></li>
</ul>

<details class="example" open>
  <summary>Using this function</summary>
  <p>Download and print the paths of all downloaded files:</p>
<pre><code>entities = syncFromSynapse(syn, "syn1234")
for f in entities:
    print(f.path)
</code></pre>
</details>
          <details class="quote">
            <summary>Source code in <code>synapseutils/sync.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;sync::syncFromSynapse&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">syncFromSynapse</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">entity</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ifcollision</span><span class="o">=</span><span class="s2">&quot;overwrite.local&quot;</span><span class="p">,</span>
    <span class="n">allFiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">followLink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">manifest</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">downloadFile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronizes all the files in a folder (including subfolders) from Synapse and adds a readme manifest with file</span>
<span class="sd">    metadata.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity:  A Synapse ID, a Synapse Entity object of type file, folder or project.</span>
<span class="sd">        path: An optional path where the file hierarchy will be reproduced. If not specified the files will by default be placed in the synapseCache.</span>
<span class="sd">        ifcollision: Determines how to handle file collisions. Maybe &quot;overwrite.local&quot;, &quot;keep.local&quot;, or &quot;keep.both&quot;.</span>
<span class="sd">        followLink: Determines whether the link returns the target Entity.</span>
<span class="sd">        manifest: Determines whether creating manifest file automatically. The optional values here (`all`, `root`, `suppress`).</span>
<span class="sd">        downloadFile: Determines whether downloading the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of entities ([files][synapseclient.File], [tables][synapseclient.Table], [links][synapseclient.Link])</span>


<span class="sd">    This function will crawl all subfolders of the project/folder specified by `entity` and download all files that have</span>
<span class="sd">    not already been downloaded.  If there are newer files in Synapse (or a local file has been edited outside of the</span>
<span class="sd">    cache) since the last download then local the file will be replaced by the new file unless &quot;ifcollision&quot; is changed.</span>

<span class="sd">    If the files are being downloaded to a specific location outside of the Synapse cache a file</span>
<span class="sd">    (SYNAPSE_METADATA_MANIFEST.tsv) will also be added in the path that contains the metadata (annotations, storage</span>
<span class="sd">    location and provenance of all downloaded files).</span>

<span class="sd">    See also:</span>

<span class="sd">    - [synapseutils.sync.syncToSynapse][]</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        Download and print the paths of all downloaded files:</span>

<span class="sd">            entities = syncFromSynapse(syn, &quot;syn1234&quot;)</span>
<span class="sd">            for f in entities:</span>
<span class="sd">                print(f.path)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">manifest</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;suppress&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Value of manifest option should be one of the (&quot;all&quot;, &quot;root&quot;, &quot;suppress&quot;)&#39;</span>
        <span class="p">)</span>

    <span class="c1"># we&#39;ll have the following threads:</span>
    <span class="c1"># 1. the entrant thread to this function walks the folder hierarchy and schedules files for download,</span>
    <span class="c1">#    and then waits for all the file downloads to complete</span>
    <span class="c1"># 2. each file download will run in a separate thread in an Executor</span>
    <span class="c1"># 3. downloads that support S3 multipart concurrent downloads will be scheduled by the thread in #2 and have</span>
    <span class="c1">#    their parts downloaded in additional threads in the same Executor</span>
    <span class="c1"># To support multipart downloads in #3 using the same Executor as the download thread #2, we need at least</span>
    <span class="c1"># 2 threads always, if those aren&#39;t available then we&#39;ll run single threaded to avoid a deadlock</span>
    <span class="k">with</span> <span class="n">_sync_executor</span><span class="p">(</span><span class="n">syn</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">sync_from_synapse</span> <span class="o">=</span> <span class="n">_SyncDownloader</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">executor</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">sync_from_synapse</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span>
            <span class="n">entity</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">ifcollision</span><span class="p">,</span> <span class="n">followLink</span><span class="p">,</span> <span class="n">downloadFile</span><span class="p">,</span> <span class="n">manifest</span>
        <span class="p">)</span>

    <span class="c1"># the allFiles parameter used to be passed in as part of the recursive implementation of this function</span>
    <span class="c1"># with the public signature invoking itself. now that this isn&#39;t a recursive any longer we don&#39;t need</span>
    <span class="c1"># allFiles as a parameter (especially on the public signature) but it is retained for now for backwards</span>
    <span class="c1"># compatibility with external invokers.</span>
    <span class="k">if</span> <span class="n">allFiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">allFiles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">allFiles</span>

    <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.sync.syncToSynapse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">syncToSynapse</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">manifestFile</span><span class="p">,</span> <span class="n">dryRun</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sendMessages</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">MAX_RETRIES</span><span class="p">)</span></code>

<a href="#synapseutils.sync.syncToSynapse" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Synchronizes files specified in the manifest file to Synapse.</p>
<p>Given a file describing all of the uploads uploads the content to Synapse and optionally notifies you via Synapse
messagging (email) at specific intervals, on errors and on completion.</p>
<p><a href="../../explanations/manifest_tsv/">Read more about the manifest file format</a></p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>manifestFile</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A tsv file with file locations and metadata to be pushed to Synapse.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dryRun</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Performs validation without uploading if set to True.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>sendMessages</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Sends out messages on completion if set to True.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/sync.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;sync::syncToSynapse&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">syncToSynapse</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span> <span class="n">manifestFile</span><span class="p">,</span> <span class="n">dryRun</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sendMessages</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">MAX_RETRIES</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronizes files specified in the manifest file to Synapse.</span>

<span class="sd">    Given a file describing all of the uploads uploads the content to Synapse and optionally notifies you via Synapse</span>
<span class="sd">    messagging (email) at specific intervals, on errors and on completion.</span>

<span class="sd">    [Read more about the manifest file format](../../explanations/manifest_tsv/)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        manifestFile: A tsv file with file locations and metadata to be pushed to Synapse.</span>
<span class="sd">        dryRun: Performs validation without uploading if set to True.</span>
<span class="sd">        sendMessages: Sends out messages on completion if set to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">readManifestFile</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">manifestFile</span><span class="p">)</span>
    <span class="c1"># have to check all size of single file</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span><span class="o">.</span><span class="n">st_size</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_url</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="c1"># Write output on what is getting pushed and estimated times - send out message.</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;We are about to upload </span><span class="si">%i</span><span class="s2"> files with a total size of </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> &quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">utils</span><span class="o">.</span><span class="n">humanizeBytes</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">sizes</span><span class="p">)))</span>
    <span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dryRun</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Starting upload...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sendMessages</span><span class="p">:</span>
        <span class="n">notify_decorator</span> <span class="o">=</span> <span class="n">notifyMe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="s2">&quot;Upload of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">manifestFile</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">)</span>
        <span class="n">upload</span> <span class="o">=</span> <span class="n">notify_decorator</span><span class="p">(</span><span class="n">_manifest_upload</span><span class="p">)</span>
        <span class="n">upload</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_manifest_upload</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.sync.generateManifest" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generateManifest</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">allFiles</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">provenance_cache</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#synapseutils.sync.generateManifest" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Generates a manifest file based on a list of entities objects.</p>
<p><a href="../../explanations/manifest_tsv/">Read more about the manifest file format</a></p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>allFiles</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A list of File Entity objects on Synapse (can't be Synapse IDs)</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>file where manifest will be written</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>provenance_cache</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>an optional dict of known provenance dicts keyed by entity ids</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/sync.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generateManifest</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">allFiles</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">provenance_cache</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a manifest file based on a list of entities objects.</span>

<span class="sd">    [Read more about the manifest file format](../../explanations/manifest_tsv/)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        allFiles: A list of File Entity objects on Synapse (can&#39;t be Synapse IDs)</span>
<span class="sd">        filename: file where manifest will be written</span>
<span class="sd">        provenance_cache: an optional dict of known provenance dicts keyed by entity ids</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">_extract_file_entity_metadata</span><span class="p">(</span>
        <span class="n">syn</span><span class="p">,</span> <span class="n">allFiles</span><span class="p">,</span> <span class="n">provenance_cache</span><span class="o">=</span><span class="n">provenance_cache</span>
    <span class="p">)</span>
    <span class="n">_write_manifest_data</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.sync.generate_sync_manifest" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_sync_manifest</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">manifest_path</span><span class="p">)</span></code>

<a href="#synapseutils.sync.generate_sync_manifest" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Generate manifest for syncToSynapse() from a local directory.</p>
<p><a href="../../explanations/manifest_tsv/">Read more about the manifest file format</a></p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>directory_path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Path to local directory to be pushed to Synapse.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>parent_id</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Synapse ID of the parent folder/project on Synapse.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>manifest_path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Path to the manifest file to be generated.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/sync.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;sync::generate_sync_manifest&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">generate_sync_manifest</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">manifest_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate manifest for syncToSynapse() from a local directory.</span>

<span class="sd">    [Read more about the manifest file format](../../explanations/manifest_tsv/)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        directory_path: Path to local directory to be pushed to Synapse.</span>
<span class="sd">        parent_id: Synapse ID of the parent folder/project on Synapse.</span>
<span class="sd">        manifest_path: Path to the manifest file to be generated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">manifest_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;parent&quot;</span><span class="p">]</span>
    <span class="n">manifest_rows</span> <span class="o">=</span> <span class="n">_walk_directory_tree</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">)</span>
    <span class="n">_write_manifest_data</span><span class="p">(</span><span class="n">manifest_path</span><span class="p">,</span> <span class="n">manifest_cols</span><span class="p">,</span> <span class="n">manifest_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.sync.readManifestFile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">readManifestFile</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">manifestFile</span><span class="p">)</span></code>

<a href="#synapseutils.sync.readManifestFile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Verifies a file manifest and returns a reordered dataframe ready for upload.</p>
<p><a href="../../explanations/manifest_tsv/">Read more about the manifest file format</a></p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>manifestFile</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A tsv file with file locations and metadata to be pushed to Synapse.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A pandas dataframe if the manifest is validated.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/sync.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;sync::readManifestFile&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">readManifestFile</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">manifestFile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verifies a file manifest and returns a reordered dataframe ready for upload.</span>

<span class="sd">    [Read more about the manifest file format](../../explanations/manifest_tsv/)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        manifestFile: A tsv file with file locations and metadata to be pushed to Synapse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A pandas dataframe if the manifest is validated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table</span><span class="o">.</span><span class="n">test_import_pandas</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="n">manifestFile</span> <span class="ow">is</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validation and upload of: &lt;stdin&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validation and upload of: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">manifestFile</span><span class="p">)</span>
    <span class="c1"># Read manifest file into pandas dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">manifestFile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;synapseStore&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">synapseStore</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_url</span><span class="p">),</span> <span class="s2">&quot;synapseStore&quot;</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># override synapseStore values to False when path is a url</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;synapseStore&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s2">&quot;synapseStore&quot;</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># remaining unset values default to True</span>
    <span class="n">df</span><span class="o">.</span><span class="n">synapseStore</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">synapseStore</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating columns of manifest...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">REQUIRED_FIELDS</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Manifest must contain a column of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating that all paths exist...&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_check_path_and_normalize</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating that all files are unique...&quot;</span><span class="p">)</span>
    <span class="c1"># Both the path and the combination of entity name and parent must be unique</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">path</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All rows in manifest must contain a unique file to upload&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check each size of uploaded file</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating that all the files are not empty...&quot;</span><span class="p">)</span>
    <span class="n">_check_size_each_file</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># check the name of each file should be store on Synapse</span>
    <span class="n">name_column</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>
    <span class="c1"># Create entity name column from basename</span>
    <span class="k">if</span> <span class="n">name_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filenames</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating file names... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">_check_file_name</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating provenance...&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_sortAndFixProvenance</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Validating that parents exist and are containers...&quot;</span><span class="p">)</span>
    <span class="n">parents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">synId</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">synId</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SynapseHTTPError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> in the parent column is not a valid Synapse Id</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">synId</span>
            <span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_container</span><span class="p">(</span><span class="n">container</span><span class="p">):</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> in the parent column is is not a Folder or Project</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">synId</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">SynapseHTTPError</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.copy_functions" class="doc doc-heading">
          <code>synapseutils.copy_functions</code>


<a href="#synapseutils.copy_functions" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">







<h3 id="synapseutils.copy_functions-functions">Functions<a href="#synapseutils.copy_functions-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.copy_functions.copy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">destinationId</span><span class="p">,</span> <span class="n">skipCopyWikiPage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skipCopyAnnotations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#synapseutils.copy_functions.copy" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <ul>
<li>This function will assist users in copying entities (Tables, Links, Files, Folders, Projects),
  and will recursively copy everything in directories.</li>
<li>A Mapping of the old entities to the new entities will be created and all the wikis of each entity
  will also be copied over and links to synapse Ids will be updated.</li>
</ul>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A synapse entity ID</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>destinationId</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Synapse ID of a folder/project that the copied entity is being copied to</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>skipCopyWikiPage</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Skip copying the wiki pages.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>skipCopyAnnotations</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Skips copying the annotations.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>version</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(File copy only) Can specify version of a file. Default to None</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>updateExisting</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(File copy only) When the destination has an entity that has the same name,
            users can choose to update that entity. It must be the same entity type
            Default to False</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>setProvenance</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(File copy only) Has three values to set the provenance of the copied entity:
            traceback: Sets to the source entity
            existing: Sets to source entity's original provenance (if it exists)
            None: No provenance is set</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>excludeTypes</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(Folder/Project copy only) Accepts a list of entity types (file, table, link) which determines
            which entity types to not copy. Defaults to an empty list.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A mapping between the original and copied entity: {'syn1234':'syn33455'}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Using this function</summary>
  <p>Sample copy:</p>
<pre><code>import synapseutils
import synapseclient
syn = synapseclient.login()
synapseutils.copy(syn, ...)
</code></pre>
<p>Copying Files:</p>
<pre><code>synapseutils.copy(syn, "syn12345", "syn45678", updateExisting=False, setProvenance = "traceback",version=None)
</code></pre>
<p>Copying Folders/Projects:</p>
<pre><code># This will copy everything in the project into the destinationId except files and tables.
synapseutils.copy(syn, "syn123450","syn345678",excludeTypes=["file","table"])
</code></pre>
</details>
          <details class="quote">
            <summary>Source code in <code>synapseutils/copy_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">entity</span><span class="p">,</span>
    <span class="n">destinationId</span><span class="p">,</span>
    <span class="n">skipCopyWikiPage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skipCopyAnnotations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - This function will assist users in copying entities (Tables, Links, Files, Folders, Projects),</span>
<span class="sd">      and will recursively copy everything in directories.</span>
<span class="sd">    - A Mapping of the old entities to the new entities will be created and all the wikis of each entity</span>
<span class="sd">      will also be copied over and links to synapse Ids will be updated.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity: A synapse entity ID</span>
<span class="sd">        destinationId: Synapse ID of a folder/project that the copied entity is being copied to</span>
<span class="sd">        skipCopyWikiPage: Skip copying the wiki pages.</span>
<span class="sd">        skipCopyAnnotations: Skips copying the annotations.</span>
<span class="sd">        version: (File copy only) Can specify version of a file. Default to None</span>
<span class="sd">        updateExisting: (File copy only) When the destination has an entity that has the same name,</span>
<span class="sd">                        users can choose to update that entity. It must be the same entity type</span>
<span class="sd">                        Default to False</span>
<span class="sd">        setProvenance: (File copy only) Has three values to set the provenance of the copied entity:</span>
<span class="sd">                        traceback: Sets to the source entity</span>
<span class="sd">                        existing: Sets to source entity&#39;s original provenance (if it exists)</span>
<span class="sd">                        None: No provenance is set</span>
<span class="sd">        excludeTypes: (Folder/Project copy only) Accepts a list of entity types (file, table, link) which determines</span>
<span class="sd">                        which entity types to not copy. Defaults to an empty list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A mapping between the original and copied entity: {&#39;syn1234&#39;:&#39;syn33455&#39;}</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        Sample copy:</span>

<span class="sd">            import synapseutils</span>
<span class="sd">            import synapseclient</span>
<span class="sd">            syn = synapseclient.login()</span>
<span class="sd">            synapseutils.copy(syn, ...)</span>

<span class="sd">        Copying Files:</span>

<span class="sd">            synapseutils.copy(syn, &quot;syn12345&quot;, &quot;syn45678&quot;, updateExisting=False, setProvenance = &quot;traceback&quot;,version=None)</span>

<span class="sd">        Copying Folders/Projects:</span>

<span class="sd">            # This will copy everything in the project into the destinationId except files and tables.</span>
<span class="sd">            synapseutils.copy(syn, &quot;syn123450&quot;,&quot;syn345678&quot;,excludeTypes=[&quot;file&quot;,&quot;table&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">updateLinks</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;updateLinks&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">updateSynIds</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;updateSynIds&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">entitySubPageId</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entitySubPageId&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">destinationSubPageId</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destinationSubPageId&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">mapping</span> <span class="o">=</span> <span class="n">_copyRecursive</span><span class="p">(</span>
        <span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">destinationId</span><span class="p">,</span> <span class="n">skipCopyAnnotations</span><span class="o">=</span><span class="n">skipCopyAnnotations</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">skipCopyWikiPage</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">oldEnt</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
            <span class="n">copyWiki</span><span class="p">(</span>
                <span class="n">syn</span><span class="p">,</span>
                <span class="n">oldEnt</span><span class="p">,</span>
                <span class="n">mapping</span><span class="p">[</span><span class="n">oldEnt</span><span class="p">],</span>
                <span class="n">entitySubPageId</span><span class="o">=</span><span class="n">entitySubPageId</span><span class="p">,</span>
                <span class="n">destinationSubPageId</span><span class="o">=</span><span class="n">destinationSubPageId</span><span class="p">,</span>
                <span class="n">updateLinks</span><span class="o">=</span><span class="n">updateLinks</span><span class="p">,</span>
                <span class="n">updateSynIds</span><span class="o">=</span><span class="n">updateSynIds</span><span class="p">,</span>
                <span class="n">entityMap</span><span class="o">=</span><span class="n">mapping</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">mapping</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.copy_functions.changeFileMetaData" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">changeFileMetaData</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">downloadAs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contentType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forceVersion</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#synapseutils.copy_functions.changeFileMetaData" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Change File Entity metadata like the download as name.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Synapse entity Id or object.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>contentType</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Specify content type to change the content type of a filehandle.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>downloadAs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Specify filename to change the filename of a filehandle.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>forceVersion</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Indicates whether the method should increment the version of the object even if nothing has changed. Defaults to True.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Synapse Entity</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Using this function</summary>
  <p>Can be used to change the filename or the file content-type without downloading:</p>
<pre><code>file_entity = syn.get(synid)
print(os.path.basename(file_entity.path))  ## prints, e.g., "my_file.txt"
file_entity = synapseutils.changeFileMetaData(syn, file_entity, "my_new_name_file.txt")
</code></pre>
</details>
          <details class="quote">
            <summary>Source code in <code>synapseutils/copy_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">changeFileMetaData</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">downloadAs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contentType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forceVersion</span><span class="o">=</span><span class="kc">True</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change File Entity metadata like the download as name.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity: Synapse entity Id or object.</span>
<span class="sd">        contentType: Specify content type to change the content type of a filehandle.</span>
<span class="sd">        downloadAs: Specify filename to change the filename of a filehandle.</span>
<span class="sd">        forceVersion: Indicates whether the method should increment the version of the object even if nothing has changed. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Synapse Entity</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        Can be used to change the filename or the file content-type without downloading:</span>

<span class="sd">            file_entity = syn.get(synid)</span>
<span class="sd">            print(os.path.basename(file_entity.path))  ## prints, e.g., &quot;my_file.txt&quot;</span>
<span class="sd">            file_entity = synapseutils.changeFileMetaData(syn, file_entity, &quot;my_new_name_file.txt&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ent</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fileResult</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">_getFileHandleDownload</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">dataFileHandleId</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">contentType</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">contentType</span> <span class="k">if</span> <span class="n">contentType</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contentType</span>
    <span class="n">downloadAs</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">fileResult</span><span class="p">[</span><span class="s2">&quot;fileHandle&quot;</span><span class="p">][</span><span class="s2">&quot;fileName&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">downloadAs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">downloadAs</span>
    <span class="p">)</span>
    <span class="n">copiedFileHandle</span> <span class="o">=</span> <span class="n">copyFileHandles</span><span class="p">(</span>
        <span class="n">syn</span><span class="p">,</span>
        <span class="p">[</span><span class="n">ent</span><span class="o">.</span><span class="n">dataFileHandleId</span><span class="p">],</span>
        <span class="p">[</span><span class="n">ent</span><span class="o">.</span><span class="n">concreteType</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">ent</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
        <span class="p">[</span><span class="n">contentType</span><span class="p">],</span>
        <span class="p">[</span><span class="n">downloadAs</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">copyResult</span> <span class="o">=</span> <span class="n">copiedFileHandle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">copyResult</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureCode&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> dataFileHandleId: </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">copyResult</span><span class="p">[</span><span class="s2">&quot;failureCode&quot;</span><span class="p">],</span> <span class="n">copyResult</span><span class="p">[</span><span class="s2">&quot;originalFileHandleId&quot;</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">dataFileHandleId</span> <span class="o">=</span> <span class="n">copyResult</span><span class="p">[</span><span class="s2">&quot;newFileHandle&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="n">ent</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="n">forceVersion</span><span class="o">=</span><span class="n">forceVersion</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ent</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.copy_functions.copyFileHandles" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copyFileHandles</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">fileHandles</span><span class="p">,</span> <span class="n">associateObjectTypes</span><span class="p">,</span> <span class="n">associateObjectIds</span><span class="p">,</span> <span class="n">newContentTypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">newFileNames</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#synapseutils.copy_functions.copyFileHandles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Given a list of fileHandle Ids or Objects, copy the fileHandles</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fileHandles</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>List of fileHandle Ids or Objects</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>associateObjectTypes</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>List of associated object types: FileEntity, TableEntity, WikiAttachment,
                    UserProfileAttachment, MessageAttachment, TeamAttachment, SubmissionAttachment,
                    VerificationSubmission (Must be the same length as fileHandles)</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>associateObjectIds</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>List of associated object Ids: If copying a file, the objectId is the synapse id,
                    and if copying a wiki attachment, the object id is the wiki subpage id.
                    (Must be the same length as fileHandles)</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>newContentTypes</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(Optional) List of content types. Set each item to a new content type for each file
                handle, or leave the item as None to keep the original content type. Default None,
                which keeps all original content types.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>newFileNames</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>(Optional) List of filenames. Set each item to a new filename for each file handle,
            or leave the item as None to keep the original name. Default None, which keeps all
            original file names.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>List of batch filehandle copy results, can include failureCodes: UNAUTHORIZED and NOT_FOUND</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code>ValueError</code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If length of all input arguments are not the same</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/copy_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copyFileHandles</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">fileHandles</span><span class="p">,</span>
    <span class="n">associateObjectTypes</span><span class="p">,</span>
    <span class="n">associateObjectIds</span><span class="p">,</span>
    <span class="n">newContentTypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">newFileNames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a list of fileHandle Ids or Objects, copy the fileHandles</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        fileHandles: List of fileHandle Ids or Objects</span>
<span class="sd">        associateObjectTypes: List of associated object types: FileEntity, TableEntity, WikiAttachment,</span>
<span class="sd">                                UserProfileAttachment, MessageAttachment, TeamAttachment, SubmissionAttachment,</span>
<span class="sd">                                VerificationSubmission (Must be the same length as fileHandles)</span>
<span class="sd">        associateObjectIds: List of associated object Ids: If copying a file, the objectId is the synapse id,</span>
<span class="sd">                                and if copying a wiki attachment, the object id is the wiki subpage id.</span>
<span class="sd">                                (Must be the same length as fileHandles)</span>
<span class="sd">        newContentTypes: (Optional) List of content types. Set each item to a new content type for each file</span>
<span class="sd">                            handle, or leave the item as None to keep the original content type. Default None,</span>
<span class="sd">                            which keeps all original content types.</span>
<span class="sd">        newFileNames: (Optional) List of filenames. Set each item to a new filename for each file handle,</span>
<span class="sd">                        or leave the item as None to keep the original name. Default None, which keeps all</span>
<span class="sd">                        original file names.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of batch filehandle copy results, can include failureCodes: UNAUTHORIZED and NOT_FOUND</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If length of all input arguments are not the same</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if length of all inputs are equal</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">fileHandles</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">associateObjectTypes</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">associateObjectIds</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">newContentTypes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">newContentTypes</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">associateObjectIds</span><span class="p">))</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">newFileNames</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">newFileNames</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">associateObjectIds</span><span class="p">))</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of all input arguments must be the same&quot;</span><span class="p">)</span>

    <span class="c1"># If no optional params passed, assign to empty list</span>
    <span class="k">if</span> <span class="n">newContentTypes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">newContentTypes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">newFileNames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">newFileNames</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Remove this line if we change API to only take fileHandleIds and not Objects</span>
    <span class="n">file_handle_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">synapseclient</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">fileHandles</span><span class="p">]</span>

    <span class="c1"># division logic for POST call here</span>
    <span class="n">master_copy_results_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list which holds all results from POST call</span>
    <span class="k">for</span> <span class="p">(</span>
        <span class="n">batch_file_handles_ids</span><span class="p">,</span>
        <span class="n">batch_assoc_obj_types</span><span class="p">,</span>
        <span class="n">batch_assoc_obj_ids</span><span class="p">,</span>
        <span class="n">batch_con_type</span><span class="p">,</span>
        <span class="n">batch_file_name</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="n">_batch_iterator_generator</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">file_handle_ids</span><span class="p">,</span>
            <span class="n">associateObjectTypes</span><span class="p">,</span>
            <span class="n">associateObjectIds</span><span class="p">,</span>
            <span class="n">newContentTypes</span><span class="p">,</span>
            <span class="n">newFileNames</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">MAX_FILE_HANDLE_PER_COPY_REQUEST</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">batch_copy_results</span> <span class="o">=</span> <span class="n">_copy_file_handles_batch</span><span class="p">(</span>
            <span class="n">syn</span><span class="p">,</span>
            <span class="n">batch_file_handles_ids</span><span class="p">,</span>
            <span class="n">batch_assoc_obj_types</span><span class="p">,</span>
            <span class="n">batch_assoc_obj_ids</span><span class="p">,</span>
            <span class="n">batch_con_type</span><span class="p">,</span>
            <span class="n">batch_file_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">master_copy_results_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_copy_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">master_copy_results_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.copy_functions.copyWiki" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copyWiki</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">destinationId</span><span class="p">,</span> <span class="n">entitySubPageId</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">destinationSubPageId</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">updateLinks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">updateSynIds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">entityMap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#synapseutils.copy_functions.copyWiki" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Copies wikis and updates internal links</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A synapse ID of an entity whose wiki you want to copy</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>destinationId</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Synapse ID of a folder/project that the wiki wants to be copied to</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>updateLinks</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Update all the internal links. (e.g. syn1234/wiki/34345 becomes syn3345/wiki/49508)</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>updateSynIds</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Update all the synapse ID's referenced in the wikis. (e.g. syn1234 becomes syn2345)
            Defaults to True but needs an entityMap</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entityMap</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An entity map {'oldSynId','newSynId'} to update the synapse IDs referenced in the wiki.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entitySubPageId</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Can specify subPageId and copy all of its subwikis
                Defaults to None, which copies the entire wiki subPageId can be found:
                https://www.synapse.org/#!Synapse:syn123/wiki/1234
                In this case, 1234 is the subPageId.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>destinationSubPageId</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Can specify destination subPageId to copy wikis to.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A list of Objects with three fields: id, title and parentId.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/copy_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copyWiki</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">entity</span><span class="p">,</span>
    <span class="n">destinationId</span><span class="p">,</span>
    <span class="n">entitySubPageId</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">destinationSubPageId</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">updateLinks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">updateSynIds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">entityMap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copies wikis and updates internal links</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity: A synapse ID of an entity whose wiki you want to copy</span>
<span class="sd">        destinationId: Synapse ID of a folder/project that the wiki wants to be copied to</span>
<span class="sd">        updateLinks: Update all the internal links. (e.g. syn1234/wiki/34345 becomes syn3345/wiki/49508)</span>
<span class="sd">        updateSynIds: Update all the synapse ID&#39;s referenced in the wikis. (e.g. syn1234 becomes syn2345)</span>
<span class="sd">                        Defaults to True but needs an entityMap</span>
<span class="sd">        entityMap: An entity map {&#39;oldSynId&#39;,&#39;newSynId&#39;} to update the synapse IDs referenced in the wiki.</span>
<span class="sd">        entitySubPageId: Can specify subPageId and copy all of its subwikis</span>
<span class="sd">                            Defaults to None, which copies the entire wiki subPageId can be found:</span>
<span class="sd">                            https://www.synapse.org/#!Synapse:syn123/wiki/1234</span>
<span class="sd">                            In this case, 1234 is the subPageId.</span>
<span class="sd">        destinationSubPageId: Can specify destination subPageId to copy wikis to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of Objects with three fields: id, title and parentId.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate input parameters</span>
    <span class="k">if</span> <span class="n">entitySubPageId</span><span class="p">:</span>
        <span class="n">entitySubPageId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">entitySubPageId</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">destinationSubPageId</span><span class="p">:</span>
        <span class="n">destinationSubPageId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">destinationSubPageId</span><span class="p">))</span>

    <span class="n">oldOwn</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># getWikiHeaders fails when there is no wiki</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">oldWikiHeaders</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">getWikiHeaders</span><span class="p">(</span><span class="n">oldOwn</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">SynapseHTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="n">newOwn</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">destinationId</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">wikiIdMap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">newWikis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># If entitySubPageId is given but not destinationSubPageId, set the pageId to &quot;&quot; (will get the root page)</span>
    <span class="c1"># A entitySubPage could be copied to a project without any wiki pages, this has to be checked</span>
    <span class="n">newWikiPage</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">destinationSubPageId</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">getWiki</span><span class="p">(</span><span class="n">newOwn</span><span class="p">,</span> <span class="n">destinationSubPageId</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SynapseHTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
    <span class="k">if</span> <span class="n">entitySubPageId</span><span class="p">:</span>
        <span class="n">oldWikiHeaders</span> <span class="o">=</span> <span class="n">_getSubWikiHeaders</span><span class="p">(</span><span class="n">oldWikiHeaders</span><span class="p">,</span> <span class="n">entitySubPageId</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">oldWikiHeaders</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">wikiHeader</span> <span class="ow">in</span> <span class="n">oldWikiHeaders</span><span class="p">:</span>
        <span class="n">wiki</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">getWiki</span><span class="p">(</span><span class="n">oldOwn</span><span class="p">,</span> <span class="n">wikiHeader</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Got wiki </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">wikiHeader</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wiki</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attachmentFileHandleIds&quot;</span><span class="p">):</span>
            <span class="n">new_file_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">syn</span><span class="o">.</span><span class="n">_getFileHandleDownload</span><span class="p">(</span>
                    <span class="n">filehandleId</span><span class="p">,</span> <span class="n">wiki</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">objectType</span><span class="o">=</span><span class="s2">&quot;WikiAttachment&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">filehandleId</span> <span class="ow">in</span> <span class="n">wiki</span><span class="p">[</span><span class="s2">&quot;attachmentFileHandleIds&quot;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Get rid of the previews</span>
            <span class="n">nopreviews</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">attach</span><span class="p">[</span><span class="s2">&quot;fileHandle&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">attach</span> <span class="ow">in</span> <span class="n">results</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">attach</span><span class="p">[</span><span class="s2">&quot;fileHandle&quot;</span><span class="p">][</span><span class="s2">&quot;isPreview&quot;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="n">contentTypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">attach</span><span class="p">[</span><span class="s2">&quot;contentType&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">attach</span> <span class="ow">in</span> <span class="n">nopreviews</span><span class="p">]</span>
            <span class="n">fileNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">attach</span><span class="p">[</span><span class="s2">&quot;fileName&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">attach</span> <span class="ow">in</span> <span class="n">nopreviews</span><span class="p">]</span>
            <span class="n">copiedFileHandles</span> <span class="o">=</span> <span class="n">copyFileHandles</span><span class="p">(</span>
                <span class="n">syn</span><span class="p">,</span>
                <span class="n">nopreviews</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;WikiAttachment&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">nopreviews</span><span class="p">),</span>
                <span class="p">[</span><span class="n">wiki</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">nopreviews</span><span class="p">),</span>
                <span class="n">contentTypes</span><span class="p">,</span>
                <span class="n">fileNames</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Check if failurecodes exist</span>
            <span class="k">for</span> <span class="n">filehandle</span> <span class="ow">in</span> <span class="n">copiedFileHandles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">filehandle</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureCode&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> dataFileHandleId: </span><span class="si">%s</span><span class="s2">&quot;</span>
                        <span class="o">%</span> <span class="p">(</span>
                            <span class="n">filehandle</span><span class="p">[</span><span class="s2">&quot;failureCode&quot;</span><span class="p">],</span>
                            <span class="n">filehandle</span><span class="p">[</span><span class="s2">&quot;originalFileHandleId&quot;</span><span class="p">],</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="n">new_file_handles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">filehandle</span><span class="p">[</span><span class="s2">&quot;newFileHandle&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">filehandle</span> <span class="ow">in</span> <span class="n">copiedFileHandles</span>
            <span class="p">]</span>
        <span class="c1"># for some reason some wikis don&#39;t have titles?</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">wikiHeader</span><span class="p">,</span> <span class="s2">&quot;parentId&quot;</span><span class="p">):</span>
            <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">Wiki</span><span class="p">(</span>
                <span class="n">owner</span><span class="o">=</span><span class="n">newOwn</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="n">wiki</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="n">markdown</span><span class="o">=</span><span class="n">wiki</span><span class="o">.</span><span class="n">markdown</span><span class="p">,</span>
                <span class="n">fileHandles</span><span class="o">=</span><span class="n">new_file_handles</span><span class="p">,</span>
                <span class="n">parentWikiId</span><span class="o">=</span><span class="n">wikiIdMap</span><span class="p">[</span><span class="n">wiki</span><span class="o">.</span><span class="n">parentWikiId</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">newWikiPage</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">destinationSubPageId</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newWikiPage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">newWikiPage</span><span class="p">[</span><span class="s2">&quot;attachmentFileHandleIds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_file_handles</span>
                <span class="n">newWikiPage</span><span class="p">[</span><span class="s2">&quot;markdown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki</span><span class="p">[</span><span class="s2">&quot;markdown&quot;</span><span class="p">]</span>
                <span class="n">newWikiPage</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wiki</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1"># Need to add logic to update titles here</span>
                <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">newWikiPage</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">Wiki</span><span class="p">(</span>
                    <span class="n">owner</span><span class="o">=</span><span class="n">newOwn</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">wiki</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="n">markdown</span><span class="o">=</span><span class="n">wiki</span><span class="o">.</span><span class="n">markdown</span><span class="p">,</span>
                    <span class="n">fileHandles</span><span class="o">=</span><span class="n">new_file_handles</span><span class="p">,</span>
                    <span class="n">parentWikiId</span><span class="o">=</span><span class="n">destinationSubPageId</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">newWikiPage</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">newWikiPage</span><span class="p">)</span>
        <span class="n">newWikis</span><span class="p">[</span><span class="n">newWikiPage</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">newWikiPage</span>
        <span class="n">wikiIdMap</span><span class="p">[</span><span class="n">wiki</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">newWikiPage</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">updateLinks</span><span class="p">:</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating internal links:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">newWikis</span> <span class="o">=</span> <span class="n">_updateInternalLinks</span><span class="p">(</span><span class="n">newWikis</span><span class="p">,</span> <span class="n">wikiIdMap</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">destinationId</span><span class="p">)</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done updating internal links.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">updateSynIds</span> <span class="ow">and</span> <span class="n">entityMap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating Synapse references:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">newWikis</span> <span class="o">=</span> <span class="n">_updateSynIds</span><span class="p">(</span><span class="n">newWikis</span><span class="p">,</span> <span class="n">wikiIdMap</span><span class="p">,</span> <span class="n">entityMap</span><span class="p">)</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done updating Synapse IDs.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Storing new Wikis</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">oldWikiId</span> <span class="ow">in</span> <span class="n">wikiIdMap</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">newWikiId</span> <span class="o">=</span> <span class="n">wikiIdMap</span><span class="p">[</span><span class="n">oldWikiId</span><span class="p">]</span>
        <span class="n">newWikis</span><span class="p">[</span><span class="n">newWikiId</span><span class="p">]</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">newWikis</span><span class="p">[</span><span class="n">newWikiId</span><span class="p">])</span>
        <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Stored: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">newWikiId</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">syn</span><span class="o">.</span><span class="n">getWikiHeaders</span><span class="p">(</span><span class="n">newOwn</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.walk_functions" class="doc doc-heading">
          <code>synapseutils.walk_functions</code>


<a href="#synapseutils.walk_functions" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">







<h3 id="synapseutils.walk_functions-functions">Functions<a href="#synapseutils.walk_functions-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.walk_functions.walk" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">walk</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">synId</span><span class="p">,</span> <span class="n">includeTypes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;entityview&#39;</span><span class="p">,</span> <span class="s1">&#39;dockerrepo&#39;</span><span class="p">,</span> <span class="s1">&#39;submissionview&#39;</span><span class="p">,</span> <span class="s1">&#39;dataset&#39;</span><span class="p">,</span> <span class="s1">&#39;materializedview&#39;</span><span class="p">])</span></code>

<a href="#synapseutils.walk_functions.walk" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Traverse through the hierarchy of files and folders stored under the synId. Has the same behavior as os.walk()</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>synId</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A synapse ID of a folder or project</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>includeTypes</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Must be a list of entity types (ie.["file", "table"])
            The "folder" type is always included so the hierarchy can be traversed</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>[&#39;folder&#39;, &#39;file&#39;, &#39;table&#39;, &#39;link&#39;, &#39;entityview&#39;, &#39;dockerrepo&#39;, &#39;submissionview&#39;, &#39;dataset&#39;, &#39;materializedview&#39;]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Using this function</summary>
  <p>Traversing through a project and printing out the directory path, folders, and files</p>
<pre><code>walkedPath = walk(syn, "syn1234", ["file"]) #Exclude tables and views

for dirpath, dirname, filename in walkedPath:
    print(dirpath)
    print(dirname) #All the folders in the directory path
    print(filename) #All the files in the directory path
</code></pre>
</details>
          <details class="quote">
            <summary>Source code in <code>synapseutils/walk_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">walk</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">,</span>
    <span class="n">synId</span><span class="p">,</span>
    <span class="n">includeTypes</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;folder&quot;</span><span class="p">,</span>
        <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;link&quot;</span><span class="p">,</span>
        <span class="s2">&quot;entityview&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dockerrepo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;submissionview&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;materializedview&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Traverse through the hierarchy of files and folders stored under the synId. Has the same behavior as os.walk()</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        synId: A synapse ID of a folder or project</span>
<span class="sd">        includeTypes: Must be a list of entity types (ie.[&quot;file&quot;, &quot;table&quot;])</span>
<span class="sd">                        The &quot;folder&quot; type is always included so the hierarchy can be traversed</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        Traversing through a project and printing out the directory path, folders, and files</span>

<span class="sd">            walkedPath = walk(syn, &quot;syn1234&quot;, [&quot;file&quot;]) #Exclude tables and views</span>

<span class="sd">            for dirpath, dirname, filename in walkedPath:</span>
<span class="sd">                print(dirpath)</span>
<span class="sd">                print(dirname) #All the folders in the directory path</span>
<span class="sd">                print(filename) #All the files in the directory path</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure that &quot;folder&quot; is included so the hierarchy can be traversed</span>
    <span class="k">if</span> <span class="s2">&quot;folder&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">includeTypes</span><span class="p">:</span>
        <span class="n">includeTypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;folder&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_helpWalk</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">synId</span><span class="p">,</span> <span class="n">includeTypes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.monitor" class="doc doc-heading">
          <code>synapseutils.monitor</code>


<a href="#synapseutils.monitor" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">







<h3 id="synapseutils.monitor-functions">Functions<a href="#synapseutils.monitor-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.monitor.notifyMe" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">notifyMe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">messageSubject</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#synapseutils.monitor.notifyMe" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Function decorator that notifies you via email whenever an function completes running or there is a failure.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>messageSubject</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string with subject line for sent out messages.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>retries</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Number of retries to attempt on failure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>0</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Using this function</summary>
  <p>As a decorator:</p>
<pre><code># to decorate a function that you define
from synapseutils import notifyMe
import synapseclient
syn = synapseclient.login()

@notifyMe(syn, 'Long running function', retries=2)
def my_function(x):
    doing_something()
    return long_runtime_func(x)

my_function(123)
</code></pre>
<p>Wrapping a function:</p>
<pre><code># to wrap a function that already exists
from synapseutils import notifyMe
import synapseclient
syn = synapseclient.login()

notify_decorator = notifyMe(syn, 'Long running query', retries=2)
my_query = notify_decorator(syn.tableQuery)
results = my_query("select id from syn1223")
</code></pre>
</details>
          <details class="quote">
            <summary>Source code in <code>synapseutils/monitor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">notifyMe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">messageSubject</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function decorator that notifies you via email whenever an function completes running or there is a failure.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        messageSubject: A string with subject line for sent out messages.</span>
<span class="sd">        retries: Number of retries to attempt on failure</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        As a decorator:</span>

<span class="sd">            # to decorate a function that you define</span>
<span class="sd">            from synapseutils import notifyMe</span>
<span class="sd">            import synapseclient</span>
<span class="sd">            syn = synapseclient.login()</span>

<span class="sd">            @notifyMe(syn, &#39;Long running function&#39;, retries=2)</span>
<span class="sd">            def my_function(x):</span>
<span class="sd">                doing_something()</span>
<span class="sd">                return long_runtime_func(x)</span>

<span class="sd">            my_function(123)</span>

<span class="sd">        Wrapping a function:</span>

<span class="sd">            # to wrap a function that already exists</span>
<span class="sd">            from synapseutils import notifyMe</span>
<span class="sd">            import synapseclient</span>
<span class="sd">            syn = synapseclient.login()</span>

<span class="sd">            notify_decorator = notifyMe(syn, &#39;Long running query&#39;, retries=2)</span>
<span class="sd">            my_query = notify_decorator(syn.tableQuery)</span>
<span class="sd">            results = my_query(&quot;select id from syn1223&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">notify_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">with_retry_and_messaging</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">attempt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">destination</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">getUserProfile</span><span class="p">()[</span><span class="s2">&quot;ownerId&quot;</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">attempt</span> <span class="o">&lt;=</span> <span class="n">retries</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="n">syn</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">destination</span><span class="p">],</span>
                        <span class="n">messageSubject</span><span class="p">,</span>
                        <span class="n">messageBody</span><span class="o">=</span><span class="s2">&quot;Call to </span><span class="si">%s</span><span class="s2"> completed successfully!&quot;</span>
                        <span class="o">%</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="n">output</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
                    <span class="n">syn</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">destination</span><span class="p">],</span>
                        <span class="n">messageSubject</span><span class="p">,</span>
                        <span class="n">messageBody</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;Encountered a temporary Failure during upload.  &quot;</span>
                            <span class="s2">&quot;Will retry </span><span class="si">%i</span><span class="s2"> more times. </span><span class="se">\n\n</span><span class="s2"> Error message was:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span>
                            <span class="o">%</span> <span class="p">(</span><span class="n">retries</span> <span class="o">-</span> <span class="n">attempt</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
                        <span class="p">),</span>
                    <span class="p">)</span>
                    <span class="n">attempt</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">with_retry_and_messaging</span>

    <span class="k">return</span> <span class="n">notify_decorator</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.monitor.with_progress_bar" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_progress_bar</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">totalCalls</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">postfix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">isBytes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#synapseutils.monitor.with_progress_bar" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Wraps a function to add a progress bar based on the number of calls to that function.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Function being wrapped with progress Bar</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>totalCalls</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>total number of items/bytes when completed</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>prefix</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>String printed before progress bar</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>prefix</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>String printed after progress bar</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>isBytes</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A boolean indicating weather to convert bytes to kB, MB, GB etc.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A wrapped function that contains a progress bar</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/monitor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_progress_bar</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">totalCalls</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">postfix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">isBytes</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a function to add a progress bar based on the number of calls to that function.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        func: Function being wrapped with progress Bar</span>
<span class="sd">        totalCalls: total number of items/bytes when completed</span>
<span class="sd">        prefix: String printed before progress bar</span>
<span class="sd">        prefix: String printed after progress bar</span>
<span class="sd">        isBytes: A boolean indicating weather to convert bytes to kB, MB, GB etc.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A wrapped function that contains a progress bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">completed</span> <span class="o">=</span> <span class="n">Value</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">progress</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
            <span class="n">completed</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">printTransferProgress</span><span class="p">(</span><span class="n">completed</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">totalCalls</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">postfix</span><span class="p">,</span> <span class="n">isBytes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">progress</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.migrate_functions" class="doc doc-heading">
          <code>synapseutils.migrate_functions</code>


<a href="#synapseutils.migrate_functions" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">






<h3 id="synapseutils.migrate_functions-classes">Classes<a href="#synapseutils.migrate_functions-classes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-class">




<h4 id="synapseutils.migrate_functions.MigrationResult" class="doc doc-heading">
          <code>MigrationResult</code>


<a href="#synapseutils.migrate_functions.MigrationResult" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">


      <p>A MigrationResult is a proxy object to the underlying sqlite db.
It provides a programmatic interface that allows the caller to iterate over the
file handles that were migrated without having to connect to or know the schema
of the sqlite db, and also avoids the potential memory liability of putting
everything into an in memory data structure that could be a liability when
migrating a huge project of hundreds of thousands/millions of entities.</p>
<p>As this proxy object is not thread safe since it accesses an underlying sqlite db.</p>

            <details class="quote">
              <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MigrationResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A MigrationResult is a proxy object to the underlying sqlite db.</span>
<span class="sd">    It provides a programmatic interface that allows the caller to iterate over the</span>
<span class="sd">    file handles that were migrated without having to connect to or know the schema</span>
<span class="sd">    of the sqlite db, and also avoids the potential memory liability of putting</span>
<span class="sd">    everything into an in memory data structure that could be a liability when</span>
<span class="sd">    migrating a huge project of hundreds of thousands/millions of entities.</span>

<span class="sd">    As this proxy object is not thread safe since it accesses an underlying sqlite db.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syn</span><span class="p">,</span> <span class="n">db_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_syn</span> <span class="o">=</span> <span class="n">syn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span>

    <span class="k">def</span> <span class="nf">get_counts_by_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of counts by the migration status of each indexed file/version.</span>
<span class="sd">        Keys are as follows:</span>

<span class="sd">        - `INDEXED` - the file/version has been indexed and will be migrated on a call to migrate_indexed_files</span>
<span class="sd">        - `MIGRATED` - the file/version has been migrated</span>
<span class="sd">        - `ALREADY_MIGRATED` - the file/version was already stored at the target storage location and no migration is needed</span>
<span class="sd">        - `ERRORED` - an error occurred while indexing or migrating the file/version</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>
        <span class="kn">import</span> <span class="nn">sqlite3</span>

        <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

            <span class="c1"># for the purposes of these counts, containers (Projects and Folders) do not count.</span>
            <span class="c1"># we are counting actual files only</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="s2">&quot;select status, count(*) from migrations where type in (?, ?) group by status&quot;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="n">counts_by_status</span> <span class="o">=</span> <span class="p">{</span><span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">_MigrationStatus</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">counts_by_status</span><span class="p">[</span><span class="n">_MigrationStatus</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>

            <span class="k">return</span> <span class="n">counts_by_status</span>

    <span class="k">def</span> <span class="nf">get_migrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A generator yielding each file/version in the migration index.</span>
<span class="sd">        A dictionary of the properties of the migration row is yielded as follows</span>

<span class="sd">        Yields:</span>
<span class="sd">            id: the Synapse id</span>
<span class="sd">            type: the concrete type of the entity</span>
<span class="sd">            version: the verson of the file entity (if applicable)</span>
<span class="sd">            row_id: the row of the table attached file (if applicable)</span>
<span class="sd">            col_id: the column id of the table attached file (if applicable)</span>
<span class="sd">            from_storage_location_id: - the previous storage location id where the file/version was stored</span>
<span class="sd">            from_file_handle_id: the id file handle of the existing file/version</span>
<span class="sd">            to_file_handle_id: if migrated, the new file handle id</span>
<span class="sd">            status: one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</span>
<span class="sd">            exception: if an error was encountered indexing/migrating the file/version its stack is here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">sqlite3</span>

        <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

            <span class="n">last_id</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">rowid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                        select</span>
<span class="sd">                            rowid,</span>

<span class="sd">                            id,</span>
<span class="sd">                            type,</span>
<span class="sd">                            version,</span>
<span class="sd">                            row_id,</span>
<span class="sd">                            col_id,</span>
<span class="sd">                            from_storage_location_id,</span>
<span class="sd">                            from_file_handle_id,</span>
<span class="sd">                            to_file_handle_id,</span>
<span class="sd">                            file_size,</span>
<span class="sd">                            status,</span>
<span class="sd">                            exception</span>
<span class="sd">                        from migrations</span>
<span class="sd">                        where</span>
<span class="sd">                            rowid &gt; ?</span>
<span class="sd">                            and type in (?, ?)</span>
<span class="sd">                        order by</span>
<span class="sd">                            rowid</span>
<span class="sd">                        limit ?</span>
<span class="sd">                    &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">rowid</span><span class="p">,</span>
                        <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                        <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                        <span class="n">_get_batch_size</span><span class="p">(),</span>
                    <span class="p">),</span>
                <span class="p">)</span>

                <span class="n">row_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                    <span class="n">row_count</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># using the internal sqlite rowid for ordering only</span>
                    <span class="n">rowid</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="c1"># exclude the sqlite internal rowid</span>
                    <span class="n">row_dict</span> <span class="o">=</span> <span class="n">_get_row_dict</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="n">entity_id</span> <span class="o">=</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">entity_id</span> <span class="o">!=</span> <span class="n">last_id</span><span class="p">:</span>
                        <span class="c1"># if the next row is dealing with a different entity than the last table</span>
                        <span class="c1"># id then we discard any cached column names we looked up</span>
                        <span class="n">column_names</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;file&quot;</span>
                        <span class="k">if</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">else</span> <span class="s2">&quot;table&quot;</span>
                    <span class="p">)</span>

                    <span class="k">for</span> <span class="n">int_arg</span> <span class="ow">in</span> <span class="p">(</span>
                        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;row_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">,</span>
                    <span class="p">):</span>
                        <span class="n">int_val</span> <span class="o">=</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">int_arg</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">int_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">row_dict</span><span class="p">[</span><span class="n">int_arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">int_val</span><span class="p">)</span>

                    <span class="n">col_id</span> <span class="o">=</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;col_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">col_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">column_name</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col_id</span><span class="p">)</span>

                        <span class="c1"># for usability we look up the actual column name from the id,</span>
                        <span class="c1"># but that involves a lookup so we cache them for re-use across</span>
                        <span class="c1"># rows that deal with the same table entity</span>
                        <span class="k">if</span> <span class="n">column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_syn</span><span class="o">.</span><span class="n">restGET</span><span class="p">(</span><span class="s2">&quot;/column/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col_id</span><span class="p">))</span>
                            <span class="n">column_name</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">col_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

                        <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;col_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">column_name</span>

                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_MigrationStatus</span><span class="p">(</span><span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span>

                    <span class="k">yield</span> <span class="n">row_dict</span>

                    <span class="n">last_id</span> <span class="o">=</span> <span class="n">entity_id</span>

                <span class="k">if</span> <span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># out of rows</span>
                    <span class="k">break</span>

    <span class="k">def</span> <span class="nf">as_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Output a flat csv file of the contents of the Migration index.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            path: The path to the csv file to be created</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: But a csv file is created at the given path with the following columns:</span>
<span class="sd">            id: the Synapse id</span>
<span class="sd">            type: the concrete type of the entity</span>
<span class="sd">            version: the verson of the file entity (if applicable)</span>
<span class="sd">            row_id: the row of the table attached file (if applicable)</span>
<span class="sd">            col_name: the column name of the column the table attached file resides in (if applicable)</span>
<span class="sd">            from_storage_location_id: the previous storage location id where the file/version was stored</span>
<span class="sd">            from_file_handle_id: the id file handle of the existing file/version</span>
<span class="sd">            to_file_handle_id: if migrated, the new file handle id</span>
<span class="sd">            status: one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</span>
<span class="sd">            exception: if an error was encountered indexing/migrating the file/version its stack is here</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
            <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>

            <span class="c1"># headers</span>
            <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;version&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;row_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;col_name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exception&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">row_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_migrations</span><span class="p">():</span>
                <span class="n">row_data</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;row_id&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;col_name&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">),</span>
                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">],</span>
                    <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exception&quot;</span><span class="p">),</span>
                <span class="p">]</span>

                <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>



  <div class="doc doc-children">







<h5 id="synapseutils.migrate_functions.MigrationResult-functions">Functions<a href="#synapseutils.migrate_functions.MigrationResult-functions" class="headerlink" title="Permanent link">&para;</a></h5>


<div class="doc doc-object doc-function">




<h6 id="synapseutils.migrate_functions.MigrationResult.get_counts_by_status" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_counts_by_status</span><span class="p">()</span></code>

<a href="#synapseutils.migrate_functions.MigrationResult.get_counts_by_status" class="headerlink" title="Permanent link">&para;</a></h6>


  <div class="doc doc-contents ">

      <p>Returns a dictionary of counts by the migration status of each indexed file/version.
Keys are as follows:</p>
<ul>
<li><code>INDEXED</code> - the file/version has been indexed and will be migrated on a call to migrate_indexed_files</li>
<li><code>MIGRATED</code> - the file/version has been migrated</li>
<li><code>ALREADY_MIGRATED</code> - the file/version was already stored at the target storage location and no migration is needed</li>
<li><code>ERRORED</code> - an error occurred while indexing or migrating the file/version</li>
</ul>

          <details class="quote">
            <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_counts_by_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of counts by the migration status of each indexed file/version.</span>
<span class="sd">    Keys are as follows:</span>

<span class="sd">    - `INDEXED` - the file/version has been indexed and will be migrated on a call to migrate_indexed_files</span>
<span class="sd">    - `MIGRATED` - the file/version has been migrated</span>
<span class="sd">    - `ALREADY_MIGRATED` - the file/version was already stored at the target storage location and no migration is needed</span>
<span class="sd">    - `ERRORED` - an error occurred while indexing or migrating the file/version</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>
    <span class="kn">import</span> <span class="nn">sqlite3</span>

    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="c1"># for the purposes of these counts, containers (Projects and Folders) do not count.</span>
        <span class="c1"># we are counting actual files only</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="s2">&quot;select status, count(*) from migrations where type in (?, ?) group by status&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">counts_by_status</span> <span class="o">=</span> <span class="p">{</span><span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">_MigrationStatus</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">counts_by_status</span><span class="p">[</span><span class="n">_MigrationStatus</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>

        <span class="k">return</span> <span class="n">counts_by_status</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="synapseutils.migrate_functions.MigrationResult.get_migrations" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_migrations</span><span class="p">()</span></code>

<a href="#synapseutils.migrate_functions.MigrationResult.get_migrations" class="headerlink" title="Permanent link">&para;</a></h6>


  <div class="doc doc-contents ">

      <p>A generator yielding each file/version in the migration index.
A dictionary of the properties of the migration row is yielded as follows</p>



  <table>
    <thead>
      <tr>
        <th><b>YIELDS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the Synapse id</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>type</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the concrete type of the entity</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>version</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the verson of the file entity (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>row_id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the row of the table attached file (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>col_id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the column id of the table attached file (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>from_storage_location_id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <ul>
<li>the previous storage location id where the file/version was stored</li>
</ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>from_file_handle_id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>the id file handle of the existing file/version</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>to_file_handle_id</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>if migrated, the new file handle id</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>status</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>exception</code>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>if an error was encountered indexing/migrating the file/version its stack is here</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_migrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generator yielding each file/version in the migration index.</span>
<span class="sd">    A dictionary of the properties of the migration row is yielded as follows</span>

<span class="sd">    Yields:</span>
<span class="sd">        id: the Synapse id</span>
<span class="sd">        type: the concrete type of the entity</span>
<span class="sd">        version: the verson of the file entity (if applicable)</span>
<span class="sd">        row_id: the row of the table attached file (if applicable)</span>
<span class="sd">        col_id: the column id of the table attached file (if applicable)</span>
<span class="sd">        from_storage_location_id: - the previous storage location id where the file/version was stored</span>
<span class="sd">        from_file_handle_id: the id file handle of the existing file/version</span>
<span class="sd">        to_file_handle_id: if migrated, the new file handle id</span>
<span class="sd">        status: one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</span>
<span class="sd">        exception: if an error was encountered indexing/migrating the file/version its stack is here</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sqlite3</span>

    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="n">last_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">rowid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    select</span>
<span class="sd">                        rowid,</span>

<span class="sd">                        id,</span>
<span class="sd">                        type,</span>
<span class="sd">                        version,</span>
<span class="sd">                        row_id,</span>
<span class="sd">                        col_id,</span>
<span class="sd">                        from_storage_location_id,</span>
<span class="sd">                        from_file_handle_id,</span>
<span class="sd">                        to_file_handle_id,</span>
<span class="sd">                        file_size,</span>
<span class="sd">                        status,</span>
<span class="sd">                        exception</span>
<span class="sd">                    from migrations</span>
<span class="sd">                    where</span>
<span class="sd">                        rowid &gt; ?</span>
<span class="sd">                        and type in (?, ?)</span>
<span class="sd">                    order by</span>
<span class="sd">                        rowid</span>
<span class="sd">                    limit ?</span>
<span class="sd">                &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">rowid</span><span class="p">,</span>
                    <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="n">_get_batch_size</span><span class="p">(),</span>
                <span class="p">),</span>
            <span class="p">)</span>

            <span class="n">row_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="n">row_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># using the internal sqlite rowid for ordering only</span>
                <span class="n">rowid</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># exclude the sqlite internal rowid</span>
                <span class="n">row_dict</span> <span class="o">=</span> <span class="n">_get_row_dict</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">entity_id</span> <span class="o">=</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">entity_id</span> <span class="o">!=</span> <span class="n">last_id</span><span class="p">:</span>
                    <span class="c1"># if the next row is dealing with a different entity than the last table</span>
                    <span class="c1"># id then we discard any cached column names we looked up</span>
                    <span class="n">column_names</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;file&quot;</span>
                    <span class="k">if</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">else</span> <span class="s2">&quot;table&quot;</span>
                <span class="p">)</span>

                <span class="k">for</span> <span class="n">int_arg</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="s2">&quot;version&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;row_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="n">int_val</span> <span class="o">=</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">int_arg</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">int_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">row_dict</span><span class="p">[</span><span class="n">int_arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">int_val</span><span class="p">)</span>

                <span class="n">col_id</span> <span class="o">=</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;col_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">col_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">column_name</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col_id</span><span class="p">)</span>

                    <span class="c1"># for usability we look up the actual column name from the id,</span>
                    <span class="c1"># but that involves a lookup so we cache them for re-use across</span>
                    <span class="c1"># rows that deal with the same table entity</span>
                    <span class="k">if</span> <span class="n">column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_syn</span><span class="o">.</span><span class="n">restGET</span><span class="p">(</span><span class="s2">&quot;/column/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col_id</span><span class="p">))</span>
                        <span class="n">column_name</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">col_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

                    <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;col_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">column_name</span>

                <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_MigrationStatus</span><span class="p">(</span><span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span>

                <span class="k">yield</span> <span class="n">row_dict</span>

                <span class="n">last_id</span> <span class="o">=</span> <span class="n">entity_id</span>

            <span class="k">if</span> <span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># out of rows</span>
                <span class="k">break</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="synapseutils.migrate_functions.MigrationResult.as_csv" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#synapseutils.migrate_functions.MigrationResult.as_csv" class="headerlink" title="Permanent link">&para;</a></h6>


  <div class="doc doc-contents ">

      <p>Output a flat csv file of the contents of the Migration index.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The path to the csv file to be created</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>None</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>But a csv file is created at the given path with the following columns:</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>id</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the Synapse id</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>type</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the concrete type of the entity</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>version</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the verson of the file entity (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>row_id</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the row of the table attached file (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>col_name</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the column name of the column the table attached file resides in (if applicable)</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>from_storage_location_id</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the previous storage location id where the file/version was stored</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>from_file_handle_id</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>the id file handle of the existing file/version</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>to_file_handle_id</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>if migrated, the new file handle id</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>status</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
              <code>exception</code>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>if an error was encountered indexing/migrating the file/version its stack is here</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Output a flat csv file of the contents of the Migration index.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: The path to the csv file to be created</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: But a csv file is created at the given path with the following columns:</span>
<span class="sd">        id: the Synapse id</span>
<span class="sd">        type: the concrete type of the entity</span>
<span class="sd">        version: the verson of the file entity (if applicable)</span>
<span class="sd">        row_id: the row of the table attached file (if applicable)</span>
<span class="sd">        col_name: the column name of the column the table attached file resides in (if applicable)</span>
<span class="sd">        from_storage_location_id: the previous storage location id where the file/version was stored</span>
<span class="sd">        from_file_handle_id: the id file handle of the existing file/version</span>
<span class="sd">        to_file_handle_id: if migrated, the new file handle id</span>
<span class="sd">        status: one of INDEXED, MIGRATED, ALREADY_MIGRATED, ERRORED indicating the status of the file/version</span>
<span class="sd">        exception: if an error was encountered indexing/migrating the file/version its stack is here</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
        <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>

        <span class="c1"># headers</span>
        <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;version&quot;</span><span class="p">,</span>
                <span class="s2">&quot;row_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;col_name&quot;</span><span class="p">,</span>
                <span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                <span class="s2">&quot;exception&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">row_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_migrations</span><span class="p">():</span>
            <span class="n">row_data</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;row_id&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;col_name&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from_storage_location_id&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;to_file_handle_id&quot;</span><span class="p">),</span>
                <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">],</span>
                <span class="n">row_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exception&quot;</span><span class="p">),</span>
            <span class="p">]</span>

            <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>
<h3 id="synapseutils.migrate_functions-functions">Functions<a href="#synapseutils.migrate_functions-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.migrate_functions.index_files_for_migration" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">index_files_for_migration</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">dest_storage_location_id</span><span class="p">,</span> <span class="n">db_path</span><span class="p">,</span> <span class="n">source_storage_location_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_version_strategy</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">include_table_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#synapseutils.migrate_functions.index_files_for_migration" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Index the given entity for migration to a new storage location. This is the first step in migrating an entity
to a new storage location using synapseutils.</p>
<p>This function will create a sqlite database at the given db_path that can be subsequently passed
to the migrate_indexed_files function for actual migration. This function itself does not modify the given entity
in any way.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="synapseclient.Synapse" href="../client/#synapseclient.Synapse">Synapse</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse entity whose files should be migrated. Can be a Project, Folder,
    File entity, or Table entity. If it is a container (a Project or Folder)
    its contents will be recursively indexed.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dest_storage_location_id</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The id of the new storage location to be migrated to.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>db_path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A path on disk where a sqlite db can be created to store the contents of the
        created index.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>source_storage_location_ids</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An optional iterable of storage location ids that
                            will be migrated. If provided, files outside of
                            one of the listed storage locations will not be
                            indexed for migration. If not provided, then all
                            files not already in the destination storage
                            location will be indexed for migrated.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Iterable">Iterable</span>[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>file_version_strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>One of "new" (default), "all", "latest", "skip" as follows:</p>
<ul>
<li><code>new</code>: will create a new version of file entities in the new storage location, leaving existing versions unchanged</li>
<li><code>all</code>: all existing versions will be migrated in place to the new storage location</li>
<li><code>latest</code>: the latest version will be migrated in place to the new storage location</li>
<li><code>skip</code>: skip migrating file entities. use this e.g. if wanting to e.g. migrate table attached files in a container while leaving the files unchanged</li>
</ul>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>&#39;new&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>include_table_files</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether to migrate files attached to tables. If False (default) then e.g. only
                    file entities in the container will be migrated and tables will be untouched.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>continue_on_error</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether any errors encountered while indexing an entity (access etc) will be raised
                    or instead just recorded in the index while allowing the index creation
                    to continue. Default is False (any errors are raised).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A MigrationResult object that can be used to inspect the contents of the index or output the index to a CSV for manual inspection.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">index_files_for_migration</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">:</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">Synapse</span><span class="p">,</span>
    <span class="n">entity</span><span class="p">,</span>
    <span class="n">dest_storage_location_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">db_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">source_storage_location_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">file_version_strategy</span><span class="o">=</span><span class="s2">&quot;new&quot;</span><span class="p">,</span>
    <span class="n">include_table_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Index the given entity for migration to a new storage location. This is the first step in migrating an entity</span>
<span class="sd">    to a new storage location using synapseutils.</span>

<span class="sd">    This function will create a sqlite database at the given db_path that can be subsequently passed</span>
<span class="sd">    to the migrate_indexed_files function for actual migration. This function itself does not modify the given entity</span>
<span class="sd">    in any way.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity: A Synapse entity whose files should be migrated. Can be a Project, Folder,</span>
<span class="sd">                File entity, or Table entity. If it is a container (a Project or Folder)</span>
<span class="sd">                its contents will be recursively indexed.</span>
<span class="sd">        dest_storage_location_id: The id of the new storage location to be migrated to.</span>
<span class="sd">        db_path: A path on disk where a sqlite db can be created to store the contents of the</span>
<span class="sd">                    created index.</span>
<span class="sd">        source_storage_location_ids: An optional iterable of storage location ids that</span>
<span class="sd">                                        will be migrated. If provided, files outside of</span>
<span class="sd">                                        one of the listed storage locations will not be</span>
<span class="sd">                                        indexed for migration. If not provided, then all</span>
<span class="sd">                                        files not already in the destination storage</span>
<span class="sd">                                        location will be indexed for migrated.</span>
<span class="sd">        file_version_strategy: One of &quot;new&quot; (default), &quot;all&quot;, &quot;latest&quot;, &quot;skip&quot; as follows:</span>

<span class="sd">            - `new`: will create a new version of file entities in the new storage location, leaving existing versions unchanged</span>
<span class="sd">            - `all`: all existing versions will be migrated in place to the new storage location</span>
<span class="sd">            - `latest`: the latest version will be migrated in place to the new storage location</span>
<span class="sd">            - `skip`: skip migrating file entities. use this e.g. if wanting to e.g. migrate table attached files in a container while leaving the files unchanged</span>
<span class="sd">        include_table_files: Whether to migrate files attached to tables. If False (default) then e.g. only</span>
<span class="sd">                                file entities in the container will be migrated and tables will be untouched.</span>
<span class="sd">        continue_on_error: Whether any errors encountered while indexing an entity (access etc) will be raised</span>
<span class="sd">                                or instead just recorded in the index while allowing the index creation</span>
<span class="sd">                                to continue. Default is False (any errors are raised).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A MigrationResult object that can be used to inspect the contents of the index or output the index to a CSV for manual inspection.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>
    <span class="n">root_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

    <span class="c1"># accept an Iterable, but easier to work internally if we can assume a list of strings</span>
    <span class="n">source_storage_location_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source_storage_location_ids</span> <span class="ow">or</span> <span class="p">[]]</span>

    <span class="n">file_version_strategies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">file_version_strategy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_version_strategies</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid file_version_strategy: </span><span class="si">{}</span><span class="s2">, must be one of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">file_version_strategy</span><span class="p">,</span> <span class="n">file_version_strategies</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">file_version_strategy</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">include_table_files</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Skipping both files entities and table attached files, nothing to migrate&quot;</span>
        <span class="p">)</span>

    <span class="n">_verify_storage_location_ownership</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">dest_storage_location_id</span><span class="p">)</span>

    <span class="n">test_import_sqlite3</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">sqlite3</span>

    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">_ensure_schema</span><span class="p">(</span><span class="n">cursor</span><span class="p">)</span>

        <span class="n">_verify_index_settings</span><span class="p">(</span>
            <span class="n">cursor</span><span class="p">,</span>
            <span class="n">db_path</span><span class="p">,</span>
            <span class="n">root_id</span><span class="p">,</span>
            <span class="n">dest_storage_location_id</span><span class="p">,</span>
            <span class="n">source_storage_location_ids</span><span class="p">,</span>
            <span class="n">file_version_strategy</span><span class="p">,</span>
            <span class="n">include_table_files</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="n">syn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">root_id</span><span class="p">,</span> <span class="n">downloadFile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_index_entity</span><span class="p">(</span>
                <span class="n">conn</span><span class="p">,</span>
                <span class="n">cursor</span><span class="p">,</span>
                <span class="n">syn</span><span class="p">,</span>
                <span class="n">entity</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="n">dest_storage_location_id</span><span class="p">,</span>
                <span class="n">source_storage_location_ids</span><span class="p">,</span>
                <span class="n">file_version_strategy</span><span class="p">,</span>
                <span class="n">include_table_files</span><span class="p">,</span>
                <span class="n">continue_on_error</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="n">_IndexingError</span> <span class="k">as</span> <span class="n">indexing_ex</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Aborted due to failure to index entity </span><span class="si">%s</span><span class="s2"> of type </span><span class="si">%s</span><span class="s2">. Use the continue_on_error option to skip &quot;</span>
                <span class="s2">&quot;over entities due to individual failures.&quot;</span><span class="p">,</span>
                <span class="n">indexing_ex</span><span class="o">.</span><span class="n">entity_id</span><span class="p">,</span>
                <span class="n">indexing_ex</span><span class="o">.</span><span class="n">concrete_type</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">raise</span> <span class="n">indexing_ex</span><span class="o">.</span><span class="n">__cause__</span>

    <span class="k">return</span> <span class="n">MigrationResult</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">db_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.migrate_functions.migrate_indexed_files" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">migrate_indexed_files</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">db_path</span><span class="p">,</span> <span class="n">create_table_snapshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#synapseutils.migrate_functions.migrate_indexed_files" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Migrate files previously indexed in a sqlite database at the given db_path using the separate
index_files_for_migration function. The files listed in the index will be migrated according to the
configuration of that index.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="synapseclient.Synapse" href="../client/#synapseclient.Synapse">Synapse</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>db_path</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A path on disk where a sqlite db was created using the index_files_for_migration function.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>create_table_snapshots</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>When updating the files in any table, whether the a snapshot of the table is
                    first created.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>continue_on_error</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether any errors encountered while migrating will be raised
                or instead just recorded in the sqlite database while allowing the migration
                to continue. Default is False (any errors are raised).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>force</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>If running in an interactive shell, migration requires an interactice confirmation.
    This can be bypassed by using the force=True option.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b>
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="synapseutils.migrate_functions.MigrationResult" href="#synapseutils.migrate_functions.MigrationResult">MigrationResult</a>, None]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A MigrationResult object that can be used to inspect the results of the migration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/migrate_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">migrate_indexed_files</span><span class="p">(</span>
    <span class="n">syn</span><span class="p">:</span> <span class="n">synapseclient</span><span class="o">.</span><span class="n">Synapse</span><span class="p">,</span>
    <span class="n">db_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">create_table_snapshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continue_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">MigrationResult</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Migrate files previously indexed in a sqlite database at the given db_path using the separate</span>
<span class="sd">    index_files_for_migration function. The files listed in the index will be migrated according to the</span>
<span class="sd">    configuration of that index.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        db_path: A path on disk where a sqlite db was created using the index_files_for_migration function.</span>
<span class="sd">        create_table_snapshots: When updating the files in any table, whether the a snapshot of the table is</span>
<span class="sd">                                first created.</span>
<span class="sd">        continue_on_error: Whether any errors encountered while migrating will be raised</span>
<span class="sd">                            or instead just recorded in the sqlite database while allowing the migration</span>
<span class="sd">                            to continue. Default is False (any errors are raised).</span>
<span class="sd">        force: If running in an interactive shell, migration requires an interactice confirmation.</span>
<span class="sd">                This can be bypassed by using the force=True option.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A MigrationResult object that can be used to inspect the results of the migration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">executor</span><span class="p">,</span> <span class="n">max_concurrent_file_copies</span> <span class="o">=</span> <span class="n">_get_executor</span><span class="p">(</span><span class="n">syn</span><span class="p">)</span>

    <span class="n">test_import_sqlite3</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">sqlite3</span>

    <span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="n">_ensure_schema</span><span class="p">(</span><span class="n">cursor</span><span class="p">)</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">_retrieve_index_settings</span><span class="p">(</span><span class="n">cursor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">settings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># no settings were available at the index given</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Unable to retrieve existing index settings from &#39;</span><span class="si">{}</span><span class="s2">&#39;. &quot;</span>
                <span class="s2">&quot;Either this path does represent a previously created migration index file or the file is corrupt.&quot;</span>
            <span class="p">)</span>

        <span class="n">dest_storage_location_id</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;dest_storage_location_id&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_confirm_migration</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">dest_storage_location_id</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Migration aborted.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">_MigrationKey</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">row_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">version</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">futures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># we keep track of the file handles that are currently being migrated</span>
        <span class="c1"># so that if we encounter multiple entities associated with the same</span>
        <span class="c1"># file handle we can copy the file handle once and update all the entities</span>
        <span class="c1"># with the single copied file handle</span>
        <span class="n">pending_file_handle_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">completed_file_handle_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># we keep track of the entity keys (syn id + version) so that we know</span>
        <span class="c1"># if we encounter the same one twice. normally we wouldn&#39;t but when we backtrack</span>
        <span class="c1"># to update any entities skipped because of a shared file handle we might</span>
        <span class="c1"># query for the same key as is already being operated on.</span>
        <span class="n">pending_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">_get_batch_size</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># we query for additional file or table associated file handles to migrate in batches</span>
            <span class="c1"># ordering by synapse id. there can be multiple file handles associated with a particular</span>
            <span class="c1"># synapse id (i.e. multiple file entity versions or multiple table attached files per table),</span>
            <span class="c1"># so the ordering and where clause need to account for that.</span>
            <span class="c1"># we also include in the query any unmigrated files that were skipped previously through</span>
            <span class="c1"># the query loop that share a file handle with a file handle id that is now finished.</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">version</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">row_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">row_id</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">row_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">col_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">col_id</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">col_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

            <span class="n">query_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;indexed_status&quot;</span><span class="p">:</span> <span class="n">_MigrationStatus</span><span class="o">.</span><span class="n">INDEXED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s2">&quot;file_type&quot;</span><span class="p">:</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;table_type&quot;</span><span class="p">:</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
                <span class="s2">&quot;row_id&quot;</span><span class="p">:</span> <span class="n">row_id</span><span class="p">,</span>
                <span class="s2">&quot;col_id&quot;</span><span class="p">:</span> <span class="n">col_id</span><span class="p">,</span>
                <span class="c1"># ensure that we aren&#39;t ever adding more items to the shared executor than allowed</span>
                <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_concurrent_file_copies</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)),</span>
            <span class="p">}</span>

            <span class="c1"># we can&#39;t use both named and positional literals in a query, so we use named</span>
            <span class="c1"># literals and then inline a string for the values for our file handle ids</span>
            <span class="c1"># since these are a dynamic list of values</span>
            <span class="n">pending_file_handle_in</span> <span class="o">=</span> <span class="s2">&quot;(&#39;&quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pending_file_handle_ids</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span>
            <span class="n">completed_file_handle_in</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;(&#39;&quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">completed_file_handle_ids</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span>
            <span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    select</span>
<span class="s2">                        id,</span>
<span class="s2">                        type,</span>
<span class="s2">                        version,</span>
<span class="s2">                        row_id,</span>
<span class="s2">                        col_id,</span>
<span class="s2">                        from_file_handle_id,</span>
<span class="s2">                        file_size</span>
<span class="s2">                    from migrations</span>
<span class="s2">                    where</span>
<span class="s2">                        status = :indexed_status</span>
<span class="s2">                        and (</span>
<span class="s2">                                (</span>
<span class="s2">                                    ((id &gt; :id and type in (:file_type, :table_type))</span>
<span class="s2">                                    or (id = :id and type = :file_type and version is not null and version &gt; :version)</span>
<span class="s2">                                    or (id = :id and type = :table_type and (row_id &gt; :row_id or (row_id = :row_id and col_id &gt; :col_id))))</span>
<span class="s2">                                    and from_file_handle_id not in </span><span class="si">{</span><span class="n">pending_file_handle_in</span><span class="si">}</span>
<span class="s2">                                ) or</span>
<span class="s2">                                (</span>
<span class="s2">                                    id &lt;= :id</span>
<span class="s2">                                    and from_file_handle_id in </span><span class="si">{</span><span class="n">completed_file_handle_in</span><span class="si">}</span>
<span class="s2">                                )</span>
<span class="s2">                        )</span>
<span class="s2">                    order by</span>
<span class="s2">                        id,</span>
<span class="s2">                        type,</span>
<span class="s2">                        row_id,</span>
<span class="s2">                        col_id,</span>
<span class="s2">                        version</span>
<span class="s2">                    limit :limit</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span>  <span class="c1"># noqa</span>
                <span class="n">query_kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">row_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="n">row_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row_dict</span> <span class="o">=</span> <span class="n">_get_row_dict</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="n">key_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="s2">&quot;row_id&quot;</span><span class="p">,</span> <span class="s2">&quot;col_id&quot;</span><span class="p">)</span>
                <span class="p">}</span>

                <span class="n">last_key</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">_MigrationKey</span><span class="p">(</span><span class="o">**</span><span class="n">key_dict</span><span class="p">)</span>
                <span class="n">from_file_handle_id</span> <span class="o">=</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;from_file_handle_id&quot;</span><span class="p">]</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">key</span> <span class="ow">in</span> <span class="n">pending_keys</span>
                    <span class="ow">or</span> <span class="n">from_file_handle_id</span> <span class="ow">in</span> <span class="n">pending_file_handle_ids</span>
                <span class="p">):</span>
                    <span class="c1"># if this record is already being migrated or it shares a file handle</span>
                    <span class="c1"># with a record that is being migrated then skip this.</span>
                    <span class="c1"># if it the record shares a file handle it will be picked up later</span>
                    <span class="c1"># when its file handle is completed.</span>
                    <span class="k">continue</span>

                <span class="n">file_size</span> <span class="o">=</span> <span class="n">row_dict</span><span class="p">[</span><span class="s2">&quot;file_size&quot;</span><span class="p">]</span>

                <span class="n">pending_keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">to_file_handle_id</span> <span class="o">=</span> <span class="n">_check_file_handle_exists</span><span class="p">(</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">(),</span> <span class="n">from_file_handle_id</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">to_file_handle_id</span><span class="p">:</span>
                    <span class="n">pending_file_handle_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">from_file_handle_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">FILE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">migration_fn</span> <span class="o">=</span> <span class="n">_create_new_file_version</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">migration_fn</span> <span class="o">=</span> <span class="n">_migrate_file_version</span>

                <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">_MigrationType</span><span class="o">.</span><span class="n">TABLE_ATTACHED_FILE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">last_key</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">key</span><span class="o">.</span><span class="n">id</span> <span class="ow">and</span> <span class="n">create_table_snapshots</span><span class="p">:</span>
                        <span class="n">syn</span><span class="o">.</span><span class="n">create_snapshot_version</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

                    <span class="n">migration_fn</span> <span class="o">=</span> <span class="n">_migrate_table_attached_file</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Unexpected type </span><span class="si">{}</span><span class="s2"> with id </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">def</span> <span class="nf">migration_task</span><span class="p">(</span>
                    <span class="n">syn</span><span class="p">,</span>
                    <span class="n">key</span><span class="p">,</span>
                    <span class="n">from_file_handle_id</span><span class="p">,</span>
                    <span class="n">to_file_handle_id</span><span class="p">,</span>
                    <span class="n">file_size</span><span class="p">,</span>
                    <span class="n">storage_location_id</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="c1"># a closure to wrap the actual function call so that we an add some local variables</span>
                    <span class="c1"># to the return tuple which will be consumed when the future is processed</span>
                    <span class="k">with</span> <span class="n">shared_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># instrument the shared executor in this thread so that we won&#39;t</span>
                            <span class="c1"># create a new executor to perform the multipart copy</span>
                            <span class="n">to_file_handle_id</span> <span class="o">=</span> <span class="n">migration_fn</span><span class="p">(</span>
                                <span class="n">syn</span><span class="p">,</span>
                                <span class="n">key</span><span class="p">,</span>
                                <span class="n">from_file_handle_id</span><span class="p">,</span>
                                <span class="n">to_file_handle_id</span><span class="p">,</span>
                                <span class="n">file_size</span><span class="p">,</span>
                                <span class="n">storage_location_id</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">from_file_handle_id</span><span class="p">,</span> <span class="n">to_file_handle_id</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">_MigrationError</span><span class="p">(</span>
                                <span class="n">key</span><span class="p">,</span> <span class="n">from_file_handle_id</span><span class="p">,</span> <span class="n">to_file_handle_id</span>
                            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

                <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
                    <span class="n">migration_task</span><span class="p">,</span>
                    <span class="n">syn</span><span class="p">,</span>
                    <span class="n">key</span><span class="p">,</span>
                    <span class="n">from_file_handle_id</span><span class="p">,</span>
                    <span class="n">to_file_handle_id</span><span class="p">,</span>
                    <span class="n">file_size</span><span class="p">,</span>
                    <span class="n">dest_storage_location_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">futures</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pending_file_handle_ids</span><span class="p">:</span>
                <span class="c1"># we&#39;ve run out of migratable sqlite rows, we have nothing else</span>
                <span class="c1"># to submit, so we break out and wait for all remaining</span>
                <span class="c1"># tasks to conclude.</span>
                <span class="k">break</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_concurrent_file_copies</span> <span class="ow">or</span> <span class="n">row_count</span> <span class="o">&lt;</span> <span class="n">batch_size</span><span class="p">:</span>
                <span class="c1"># if we have no concurrency left to process any additional entities</span>
                <span class="c1"># or if we&#39;re near the end of he migration and have a small</span>
                <span class="c1"># remainder batch then we wait for one of the processing migrations</span>
                <span class="c1"># to finish. a small batch doesn&#39;t mean this is the last batch since</span>
                <span class="c1"># a completed file handle here could be associated with another</span>
                <span class="c1"># entity that we deferred before because it shared the same file handle id</span>
                <span class="n">futures</span><span class="p">,</span> <span class="n">completed_file_handle_ids</span> <span class="o">=</span> <span class="n">_wait_futures</span><span class="p">(</span>
                    <span class="n">conn</span><span class="p">,</span>
                    <span class="n">cursor</span><span class="p">,</span>
                    <span class="n">futures</span><span class="p">,</span>
                    <span class="n">pending_keys</span><span class="p">,</span>
                    <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span><span class="p">,</span>
                    <span class="n">continue_on_error</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">pending_file_handle_ids</span> <span class="o">-=</span> <span class="n">completed_file_handle_ids</span>

        <span class="k">if</span> <span class="n">futures</span><span class="p">:</span>
            <span class="c1"># wait for all remaining migrations to conclude before returning</span>
            <span class="n">_wait_futures</span><span class="p">(</span>
                <span class="n">conn</span><span class="p">,</span>
                <span class="n">cursor</span><span class="p">,</span>
                <span class="n">futures</span><span class="p">,</span>
                <span class="n">pending_keys</span><span class="p">,</span>
                <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ALL_COMPLETED</span><span class="p">,</span>
                <span class="n">continue_on_error</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">MigrationResult</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">db_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="synapseutils.describe_functions" class="doc doc-heading">
          <code>synapseutils.describe_functions</code>


<a href="#synapseutils.describe_functions" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">



  <div class="doc doc-children">







<h3 id="synapseutils.describe_functions-functions">Functions<a href="#synapseutils.describe_functions-functions" class="headerlink" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">




<h4 id="synapseutils.describe_functions.describe" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">describe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">)</span></code>

<a href="#synapseutils.describe_functions.describe" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

      <p>Gets a synapse entity and returns summary statistics about it.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>syn</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A Synapse object with user's login, e.g. syn = synapseclient.login()</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>synapse id of the entity to be described</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Using this function</summary>
  <p>Describing columns of a table</p>
<pre><code>import synapseclient
import synapseutils
syn = synapseclient.login()
statistics = synapseutils(syn, entity="syn123")
print(statistics)
{
    "column1": {
        "dtype": "object",
        "mode": "FOOBAR"
    },
    "column2": {
        "dtype": "int64",
        "mode": 1,
        "min": 1,
        "max": 2,
        "mean": 1.4
    },
    "column3": {
        "dtype": "bool",
        "mode": false,
        "min": false,
        "max": true,
        "mean": 0.5
    }
}
</code></pre>
</details>


  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="typing.Union">Union</span>[dict, None]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A dict if the dataset is valid; None if not.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>synapseutils/describe_functions.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets a synapse entity and returns summary statistics about it.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        syn: A Synapse object with user&#39;s login, e.g. syn = synapseclient.login()</span>
<span class="sd">        entity: synapse id of the entity to be described</span>

<span class="sd">    Example: Using this function</span>
<span class="sd">        Describing columns of a table</span>

<span class="sd">            import synapseclient</span>
<span class="sd">            import synapseutils</span>
<span class="sd">            syn = synapseclient.login()</span>
<span class="sd">            statistics = synapseutils(syn, entity=&quot;syn123&quot;)</span>
<span class="sd">            print(statistics)</span>
<span class="sd">            {</span>
<span class="sd">                &quot;column1&quot;: {</span>
<span class="sd">                    &quot;dtype&quot;: &quot;object&quot;,</span>
<span class="sd">                    &quot;mode&quot;: &quot;FOOBAR&quot;</span>
<span class="sd">                },</span>
<span class="sd">                &quot;column2&quot;: {</span>
<span class="sd">                    &quot;dtype&quot;: &quot;int64&quot;,</span>
<span class="sd">                    &quot;mode&quot;: 1,</span>
<span class="sd">                    &quot;min&quot;: 1,</span>
<span class="sd">                    &quot;max&quot;: 2,</span>
<span class="sd">                    &quot;mean&quot;: 1.4</span>
<span class="sd">                },</span>
<span class="sd">                &quot;column3&quot;: {</span>
<span class="sd">                    &quot;dtype&quot;: &quot;bool&quot;,</span>
<span class="sd">                    &quot;mode&quot;: false,</span>
<span class="sd">                    &quot;min&quot;: false,</span>
<span class="sd">                    &quot;max&quot;: true,</span>
<span class="sd">                    &quot;mean&quot;: 0.5</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict if the dataset is valid; None if not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_open_entity_as_df</span><span class="p">(</span><span class="n">syn</span><span class="o">=</span><span class="n">syn</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="n">entity</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">stats</span> <span class="o">=</span> <span class="n">_describe_wrapper</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">syn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>













              </article>
            </div>


<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>

      </main>

        <footer class="md-footer">



      <nav class="md-footer__inner md-grid" aria-label="Footer" >


          <a href="../client/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Client">
            <div class="md-footer__button md-icon">

              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Client
              </div>
            </div>
          </a>



          <a href="../entity/" class="md-footer__link md-footer__link--next" aria-label="Next: Entity">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Entity
              </div>
            </div>
            <div class="md-footer__button md-icon">

              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>

      </nav>


  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">


    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>

</div>

        <div class="md-social">








    <a href="https://github.com/Sage-Bionetworks/synapsePythonClient" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>








    <a href="https://github.com/Sage-Bionetworks/synapsePythonClient/pkgs/container/synapsepythonclient" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>








    <a href="https://pypi.org/project/synapseclient/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>

</div>

    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>


    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.footer", "navigation.sections", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>


      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>

        <script src="../../termynal.js"></script>


  </body>
</html>
